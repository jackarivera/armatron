var Fs=Object.defineProperty;var Ds=(p,r,a)=>r in p?Fs(p,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):p[r]=a;var Ne=(p,r,a)=>Ds(p,typeof r!="symbol"?r+"":r,a);import{j as o,L as mt,F as pn,B as gt,C as bt,a as dt,V as be,b as Ee,D as Is,c as Os,d as fn,M as Te,e as Yt,S as Vs,T as mn,f as Be,A as Qt,g as Us,h as He,i as qs,k as Ks,l as Gs,P as Xt,O as Js,m as Bs,n as zs,o as Hs,p as $s,G as Zt,Q as kt,q as en,r as Ws,s as Ys,t as tn,u as Qs,v as Le,w as Xs,x as Zs,y as ei,R as Qe,z as nn,E as nt,H as gn,I as ti,J as ni,K as si,N as ii,U as oi,W as bn,X as ri,Y as ai,Z as ci,$ as li,a0 as di,a1 as ui}from"./three-3s6q0L1q.js";import{r as B,b as hi,c as xt,L as ut,B as pi,e as fi,f as sn}from"./vendor-DtzrXAz5.js";import{l as mi,e as gi}from"./socket-gfxxndMR.js";import{C as bi,a as xi,L as yi,P as ji,b as wi,p as ki,c as Ci,d as Ni,e as Ai}from"./charts-Djcs5jsp.js";import{s as Ie,P as xe,u as vi,a as Ti,i as st,T as Ae,G as _e,b as Me,B as je,L as xn,c as yn,d as jn,e as _i,I as ze,D as wn,f as kn,g as Cn,h as Nn,C as on,j as Si,k as Ei,S as Ri,A as Mi,l as Li,m as Pi,n as Fi,M as Di,o as ht,p as Ii,q as Oi,r as Vi,t as Ui,v as qi,w as Ki}from"./mui-CllA2Ma5.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))c(f);new MutationObserver(f=>{for(const d of f)if(d.type==="childList")for(const x of d.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&c(x)}).observe(document,{childList:!0,subtree:!0});function a(f){const d={};return f.integrity&&(d.integrity=f.integrity),f.referrerPolicy&&(d.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?d.credentials="include":f.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function c(f){if(f.ep)return;f.ep=!0;const d=a(f);fetch(f.href,d)}})();const Pe=class Pe{constructor(){Ne(this,"socket",null);Ne(this,"motorStateCallbacks",[]);Ne(this,"isConnecting",!1);Ne(this,"reconnectAttempts",0);Ne(this,"MAX_RECONNECT_ATTEMPTS",5)}static getInstance(){return Pe.instance||(Pe.instance=new Pe),Pe.instance}connect(){var a;if((a=this.socket)!=null&&a.connected||this.isConnecting)return;this.isConnecting=!0;const r=window.location.hostname;this.socket=mi(`http://${r}:8888`,{reconnection:!0,reconnectionAttempts:this.MAX_RECONNECT_ATTEMPTS,reconnectionDelay:1e3,reconnectionDelayMax:5e3,timeout:2e4}),this.setupListeners()}setupListeners(){this.socket&&(this.socket.on("motorStates",r=>{r&&r.motors&&this.motorStateCallbacks.forEach(a=>a(r))}),this.socket.on("connect",()=>{console.log("Connected to server"),this.isConnecting=!1,this.reconnectAttempts=0}),this.socket.on("disconnect",()=>{console.log("Disconnected from server"),this.isConnecting=!1}),this.socket.on("connect_error",r=>{var a;console.error("Connection error:",r),this.isConnecting=!1,this.reconnectAttempts++,this.reconnectAttempts>=this.MAX_RECONNECT_ATTEMPTS&&(console.error("Max reconnection attempts reached"),(a=this.socket)==null||a.disconnect())}))}sendCommand(r){var a;(a=this.socket)!=null&&a.connected?this.socket.emit("sendCommand",r):console.warn("Cannot send command: Socket not connected")}onMotorStates(r){return this.motorStateCallbacks.push(r),()=>{this.motorStateCallbacks=this.motorStateCallbacks.filter(a=>a!==r)}}on(r,a){this.socket&&this.socket.on(r,a)}off(r,a){var c;(c=this.socket)==null||c.off(r,a)}emit(r,...a){var c;(c=this.socket)==null||c.emit(r,...a)}isConnected(){var r;return((r=this.socket)==null?void 0:r.connected)||!1}};Ne(Pe,"instance");let yt=Pe;const de=yt.getInstance(),Fe=class Fe{constructor(){}static getInstance(){return Fe.instance||(Fe.instance=new Fe),Fe.instance}motorOn(r){this.sendCommand({cmd:"motorOn",motorID:r})}motorOff(r){this.sendCommand({cmd:"motorOff",motorID:r})}motorStop(r){this.sendCommand({cmd:"motorStop",motorID:r})}clearMotorError(r){this.sendCommand({cmd:"clearMotorError",motorID:r})}syncSingleAndMulti(r){this.sendCommand({cmd:"syncSingleAndMulti",motorID:r})}setTorque(r,a){this.sendCommand({cmd:"setTorque",motorID:r,value:a})}setPosition(r,a,c){this.sendCommand({cmd:"setMultiAngleWithSpeed",motorID:r,angle:a,maxSpeed:c})}setMultiJointAngles(r,a){this.sendCommand({cmd:"setMultiJointAngles",angles:r,speeds:a})}emergencyStop(){for(let r=1;r<=7;r++)this.motorStop(r)}writePID_RAM(r,a,c,f,d,x,j){this.sendCommand({cmd:"writePID_RAM",motorID:r,angKp:a,angKi:c,spdKp:f,spdKi:d,iqKp:x,iqKi:j})}readPID(r){this.sendCommand({cmd:"readPID",motorID:r})}writePID_ROM(r,a,c,f,d,x,j){this.sendCommand({cmd:"writePID_ROM",motorID:r,angKp:a,angKi:c,spdKp:f,spdKi:d,iqKp:x,iqKi:j})}readEncoder(r){this.sendCommand({cmd:"readEncoder",motorID:r})}writeEncoderZero(r,a){this.sendCommand({cmd:"writeEncoderOffset",motorID:r,encoderValue:a})}writeCurrentPosAsZero(r){this.sendCommand({cmd:"writeCurrentPosAsZero",motorID:r})}writeAcceleration(r,a){this.sendCommand({cmd:"writeAcceleration",motorID:r,accelVal:a})}readAcceleration(r){this.sendCommand({cmd:"readAcceleration",motorID:r})}sendCommand(r){de.sendCommand(r)}};Ne(Fe,"instance");let jt=Fe;const me=jt.getInstance();bi.register(xi,yi,ji,wi,ki,Ci,Ni);const Gi=({jointId:p})=>{var H,M,G,b,X;const[r,a]=B.useState(null),[c,f]=B.useState(50),[d,x]=B.useState(90),[j,C]=B.useState(360),[v,T]=B.useState({labels:[],datasets:[{label:"Position (deg)",data:[],borderColor:"blue",fill:!1},{label:"Speed (deg/s)",data:[],borderColor:"red",fill:!1},{label:"Torque",data:[],borderColor:"purple",fill:!1}]}),K=V=>{const L=new Date().toLocaleTimeString();T(u=>{const k=[...u.labels,L],g=[...u.datasets[0].data,V.multiTurnDeg_Mapped??0],U=[...u.datasets[1].data,V.speedDeg_s],z=[...u.datasets[2].data,V.torqueA];return k.length>200&&(k.shift(),g.shift(),U.shift(),z.shift()),{labels:k,datasets:[{...u.datasets[0],data:g},{...u.datasets[1],data:U},{...u.datasets[2],data:z}]}})};return B.useEffect(()=>{const V=de.onMotorStates(L=>{const u=L.motors[String(p)];u&&(a(u),K(u))});return()=>{V()}},[p]),o.jsxs("div",{className:"card",id:`card-${p}`,children:[o.jsxs("h3",{children:["Joint ",p]}),o.jsxs("div",{className:"card-content",children:[o.jsxs("div",{className:"card-left",children:[o.jsxs("div",{className:"data-section",children:[o.jsxs("div",{children:["Temperature: ",o.jsx("span",{className:"temp",children:(r==null?void 0:r.temp.toFixed(2))||"--"})]}),o.jsxs("div",{children:["Torque: ",o.jsx("span",{className:"torque",children:(r==null?void 0:r.torqueA.toFixed(2))||"--"})]}),o.jsxs("div",{children:["Speed: ",o.jsx("span",{className:"speed",children:(r==null?void 0:r.speedDeg_s.toFixed(2))||"--"})]}),o.jsxs("div",{children:["Encoder: ",o.jsx("span",{className:"enc",children:((H=r==null?void 0:r.encoder_val)==null?void 0:H.toFixed(6))||"--"})]}),o.jsxs("div",{children:["Error: ",o.jsx("span",{className:"error",children:r!=null&&r.error?"YES":"NO"})]}),o.jsx("br",{}),o.jsxs("div",{children:["[Single Turn] Raw Angle: ",o.jsx("span",{className:"position",children:(r==null?void 0:r.posDeg.toFixed(6))||"--"})]}),o.jsxs("div",{children:["[Single Turn] Remapped Angle [rad]: ",o.jsx("span",{className:"pos_remapped_rad",children:((M=r==null?void 0:r.positionRad_Mapped)==null?void 0:M.toFixed(6))||"--"})]}),o.jsxs("div",{children:["[Single Turn] Remapped Angle [deg]: ",o.jsx("span",{className:"pos_remapped_deg",children:((G=r==null?void 0:r.positionDeg_Mapped)==null?void 0:G.toFixed(6))||"--"})]}),o.jsx("br",{}),o.jsxs("div",{children:["[Multi Turn] Raw Angle: ",o.jsx("span",{className:"position_multi",children:(r==null?void 0:r.multiTurnRaw.toFixed(6))||"--"})]}),o.jsxs("div",{children:["[Multi Turn] Remapped Angle [rad]: ",o.jsx("span",{className:"pos_remapped_rad_multi",children:((b=r==null?void 0:r.multiTurnRad_Mapped)==null?void 0:b.toFixed(6))||"--"})]}),o.jsxs("div",{children:["[Multi Turn] Remapped Angle [deg]: ",o.jsx("span",{className:"pos_remapped_deg_multi",children:((X=r==null?void 0:r.multiTurnDeg_Mapped)==null?void 0:X.toFixed(6))||"--"})]})]}),o.jsxs("div",{className:"local-controls",children:[o.jsx("button",{onClick:()=>me.motorOn(p),children:"Motor ON"}),o.jsx("button",{onClick:()=>me.motorOff(p),children:"Motor OFF"}),o.jsx("button",{onClick:()=>me.motorStop(p),children:"Motor STOP"}),o.jsx("button",{onClick:()=>me.clearMotorError(p),children:"Clear Error"}),o.jsx("button",{onClick:()=>me.syncSingleAndMulti(p),children:"Sync Angles"}),o.jsxs("div",{children:[o.jsx("label",{children:"Torque (raw):"}),o.jsx("input",{type:"number",value:c,onChange:V=>f(Number(V.target.value))}),o.jsx("button",{onClick:()=>me.setTorque(p,c),children:"Set Torque"})]}),o.jsxs("div",{children:[o.jsx("label",{children:"Position (deg):"}),o.jsx("input",{type:"number",value:d,onChange:V=>x(Number(V.target.value))}),o.jsx("label",{children:"MaxSpeed (dps):"}),o.jsx("input",{type:"number",value:j,onChange:V=>C(Number(V.target.value))}),o.jsx("button",{onClick:()=>me.setPosition(p,d,j),children:"Set Position"})]})]})]}),o.jsx("div",{className:"card-right",children:o.jsx(Ai,{data:v,options:{animation:!1,scales:{x:{display:!1}}}})})]})]})},Ji=({savedSets:p,onDeleteSet:r,onUpdateSet:a})=>{const[c,f]=B.useState(null),[d,x]=B.useState(null),[j,C]=B.useState(!1),v=b=>{f(b),x({...p[b]}),C(!1)},T=()=>{f(null),x(null),C(!1)},K=()=>{c&&d&&(a(c,d),f(null),x(null),C(!1))},H=(b,X,V)=>{if(d){const L={...d};X==="angle"?L.angles[b]=parseFloat(V)||0:L.speeds[b]=parseFloat(V)||0,x(L),C(!0)}},M=b=>{me.setMultiJointAngles(b.angles,b.speeds)},G=b=>{window.confirm(`Are you sure you want to delete the set "${b}"?`)&&r(b)};return o.jsx("div",{className:"saved-sets-list",children:Object.entries(p).map(([b,X])=>o.jsxs("div",{className:"saved-set-item",children:[o.jsxs("div",{className:"set-header",children:[o.jsx("h4",{children:b}),o.jsxs("div",{className:"set-actions",children:[o.jsx("button",{onClick:()=>M(X),children:"Set Angles"}),o.jsx("button",{onClick:()=>G(b),children:"ðŸ—‘ï¸"})]})]}),o.jsx("div",{className:"set-values",children:[1,2,3,4,5,6,7].map(V=>o.jsxs("div",{className:"joint-value",children:[o.jsxs("span",{className:"joint-label",children:["Joint ",V,":"]}),c===b?o.jsxs(o.Fragment,{children:[o.jsx("input",{type:"number",value:d==null?void 0:d.angles[V-1],onChange:L=>H(V-1,"angle",L.target.value),className:"editable-input"}),o.jsx("input",{type:"number",value:d==null?void 0:d.speeds[V-1],onChange:L=>H(V-1,"speed",L.target.value),className:"editable-input"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("span",{className:"value-display",children:[X.angles[V-1],"Â°"]}),o.jsxs("span",{className:"value-display",children:[X.speeds[V-1]," dps"]})]})]},V))}),c===b?o.jsxs("div",{className:"edit-actions",children:[o.jsx("button",{onClick:K,disabled:!j,children:"Save Changes"}),o.jsx("button",{onClick:T,children:"Cancel"})]}):o.jsx("button",{onClick:()=>v(b),children:"Edit"})]},b))})},Bi=()=>{const[p,r]=B.useState([-1,-1,-1,-1,-1,-1,-1]),[a,c]=B.useState([30,30,30,30,30,30,30]),[f,d]=B.useState(""),[x,j]=B.useState({});B.useEffect(()=>{const b=localStorage.getItem("savedAngleSets");b&&j(JSON.parse(b))},[]),B.useEffect(()=>{localStorage.setItem("savedAngleSets",JSON.stringify(x))},[x]);const C=(b,X)=>{const V=[...p];V[b]=parseFloat(X)||0,r(V)},v=(b,X)=>{const V=[...a];V[b]=parseFloat(X)||0,c(V)},T=()=>{me.setMultiJointAngles(p,a)},K=()=>{me.emergencyStop()},H=()=>{if(!f.trim()){alert("Please provide a name for the set");return}j(b=>({...b,[f]:{angles:[...p],speeds:[...a]}})),d(""),alert(`Set saved as '${f}'`)},M=b=>{j(X=>{const V={...X};return delete V[b],V})},G=(b,X)=>{j(V=>({...V,[b]:X}))};return o.jsxs("div",{id:"multiJointControl",className:"container",children:[o.jsx("h2",{children:"Multi Joint Setpoints"}),o.jsx("div",{className:"multi-joint-grid",children:[1,2,3,4,5,6,7].map(b=>o.jsxs("div",{className:"multi-joint-column","data-joint":b,children:[o.jsxs("h3",{children:["Joint ",b]}),o.jsx("label",{children:"Angle (deg):"}),o.jsx("input",{type:"number",id:`multiAngle-${b}`,value:p[b-1],onChange:X=>C(b-1,X.target.value)}),o.jsx("label",{children:"Max Speed (dps):"}),o.jsx("input",{type:"number",id:`multiSpeed-${b}`,value:a[b-1],onChange:X=>v(b-1,X.target.value)})]},b))}),o.jsxs("div",{className:"multi-joint-actions",children:[o.jsx("button",{id:"sendMultiJoint",onClick:T,children:"Send Multi Joint Command"}),o.jsx("button",{id:"emergencyStop",className:"estop",onClick:K,children:"ESTOP"})]}),o.jsxs("div",{className:"saved-sets",children:[o.jsx("h3",{children:"Saved Angle Sets"}),o.jsxs("div",{className:"save-set-inputs",children:[o.jsx("input",{type:"text",value:f,onChange:b=>d(b.target.value),placeholder:"Name this set"}),o.jsx("button",{onClick:H,children:"Save Set"})]}),o.jsx(Ji,{savedSets:x,onDeleteSet:M,onUpdateSet:G})]})]})},De=class De extends gi.EventEmitter{constructor(){super();Ne(this,"state",{motors:{},diff_roll_rad:0,diff_pitch_rad:0,diff_roll_deg:0,diff_pitch_deg:0,connected:!1,lastUpdate:0});Ne(this,"connectionCheckInterval",null);Ne(this,"CONNECTION_TIMEOUT_MS",1e3);this.setupSocketListeners(),this.startConnectionCheck(),de.onMotorStates(a=>{console.log("[RobotStateService] Received data via onMotorStates callback",a),this.handleMotorStates(a)})}static getInstance(){return De.instance||(De.instance=new De),De.instance}startConnectionCheck(){this.connectionCheckInterval=setInterval(()=>{const c=Date.now()-this.state.lastUpdate<this.CONNECTION_TIMEOUT_MS;this.state.connected!==c&&(this.state.connected=c,this.emit("update",this.state))},100)}setupSocketListeners(){de.on("connect",()=>{this.state.lastUpdate=Date.now(),this.emit("update",this.state)}),de.on("disconnect",()=>{this.state.connected=!1,this.state.lastUpdate=Date.now(),this.emit("update",this.state)}),de.on("connect_error",()=>{this.state.connected=!1,this.state.lastUpdate=Date.now(),this.emit("update",this.state)})}handleMotorStates(a){try{const c={connected:!0,lastUpdate:Date.now(),motors:{},diff_roll_rad:0,diff_pitch_rad:0,diff_roll_deg:0,diff_pitch_deg:0,twin:{active:!1,joint_angles_deg:[0,0,0,0,0,0,0],diff_roll_rad:0,diff_pitch_rad:0}};if(a.motors?Object.entries(a.motors).forEach(([f,d])=>{if(!d){console.warn(`[RobotStateService] Missing data for motor ${f}`);return}try{console.log(`[RobotStateService] Processing motor ${f} data:`,d),c.motors[f]={temp:d.temp||0,torqueA:d.torqueA||0,speedDeg_s:d.speedDeg_s||0,posDeg:d.posDeg||0,multiTurnRaw:d.multiTurnRaw||0,multiTurnRad_Mapped:d.multiTurnRad_Mapped,multiTurnDeg_Mapped:d.multiTurnDeg_Mapped,error:d.error||0,encoder_val:d.encoder_val,positionRad_Mapped:d.positionRad_Mapped,positionDeg_Mapped:d.positionDeg_Mapped,gains:d.gains?{angKp:d.gains.angKp||0,angKi:d.gains.angKi||0,spdKp:d.gains.spdKp||0,spdKi:d.gains.spdKi||0,iqKp:d.gains.iqKp||0,iqKi:d.gains.iqKi||0}:void 0},console.log(`[RobotStateService] Processed motor ${f} gains:`,c.motors[f].gains)}catch(x){console.error(`[RobotStateService] Error processing motor ${f} data:`,x)}}):console.warn("[RobotStateService] Received data without motors property"),a.diff_roll_rad!==void 0&&(c.diff_roll_rad=a.diff_roll_rad),a.diff_pitch_rad!==void 0&&(c.diff_pitch_rad=a.diff_pitch_rad),a.diff_roll_deg!==void 0&&(c.diff_roll_deg=a.diff_roll_deg),a.diff_pitch_deg!==void 0&&(c.diff_pitch_deg=a.diff_pitch_deg),a.twin)try{c.twin={active:!!a.twin.active,joint_angles_deg:Array.isArray(a.twin.joint_angles_deg)?a.twin.joint_angles_deg:[0,0,0,0,0,0,0],diff_roll_rad:Array.isArray(a.twin.joint_angles_deg)&&a.twin.joint_angles_deg.length>6?a.twin.joint_angles_deg[6]:0,diff_pitch_rad:Array.isArray(a.twin.joint_angles_deg)&&a.twin.joint_angles_deg.length>5?a.twin.joint_angles_deg[5]:0}}catch(f){console.error("[RobotStateService] Error processing twin data:",f)}console.log("[RobotStateService] Updating state with new data"),this.updateState(c)}catch(c){console.error("[RobotStateService] Error handling motor states:",c)}}getState(){return{...this.state}}getMotorState(a){return this.state.motors[a]}isConnected(){return this.state.connected}getLastUpdate(){return this.state.lastUpdate}cleanup(){this.connectionCheckInterval&&clearInterval(this.connectionCheckInterval)}updateState(a){this.state={...this.state,...a,motors:{...this.state.motors,...a.motors},twin:{...this.state.twin||{active:!1,joint_angles_deg:[]},...a.twin||{}},connected:this.state.connected,lastUpdate:Date.now()},this.emit("update",this.state)}updateTwinState(a){this.state={...this.state,twin:{...this.state.twin||{active:!1,joint_angles_deg:[]},...a}},this.emit("update",this.state)}};Ne(De,"instance");let wt=De;const ke=wt.getInstance(),zi=Ie("div")(({theme:p})=>({marginBottom:p.spacing(2),padding:p.spacing(2),backgroundColor:p.palette.background.paper,borderRadius:p.shape.borderRadius,boxShadow:p.shadows[1]})),Hi=Ie("div")(({theme:p})=>({display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:p.spacing(1),marginTop:p.spacing(1)})),Ke=Ie("div")(({theme:p})=>({display:"flex",justifyContent:"space-between",alignItems:"center",padding:p.spacing(.5),borderBottom:`1px solid ${p.palette.divider}`})),Ge=Ie("span")(({theme:p})=>({fontWeight:"bold",color:p.palette.primary.main})),$i=()=>{const[p,r]=B.useState(1),[a,c]=B.useState({angKp:100,angKi:50,spdKp:50,spdKi:20,iqKp:50,iqKi:50}),[f,d]=B.useState(0),[x,j]=B.useState(1e3),[C,v]=B.useState(null);B.useEffect(()=>{const u=()=>{const g=ke.getState().motors[p.toString()];console.log("[GlobalControls] State update received:",g),g!=null&&g.gains&&(console.log("[GlobalControls] Updating gains:",g.gains),v(g.gains),c({angKp:g.gains.angKp,angKi:g.gains.angKi,spdKp:g.gains.spdKp,spdKi:g.gains.spdKi,iqKp:g.gains.iqKp,iqKi:g.gains.iqKi}))};return u(),ke.on("update",u),()=>{ke.off("update",u)}},[p]);const T=(u,k)=>{c(g=>({...g,[u]:parseInt(k)||0}))},K=()=>{console.log("[GlobalControls] Reading PID for joint:",p),me.readPID(p)},H=()=>{me.writePID_RAM(p,a.angKp,a.angKi,a.spdKp,a.spdKi,a.iqKp,a.iqKi)},M=()=>{me.writePID_ROM(p,a.angKp,a.angKi,a.spdKp,a.spdKi,a.iqKp,a.iqKi)},G=()=>{me.readEncoder(p)},b=()=>{me.writeEncoderZero(p,f)},X=()=>{me.writeCurrentPosAsZero(p)},V=()=>{me.writeAcceleration(p,x)},L=()=>{me.readAcceleration(p)};return o.jsxs("div",{id:"globalControls",className:"container global-controls",children:[o.jsx("h2",{children:"Global Controls"}),o.jsxs("div",{className:"joint-selector",children:[o.jsx("label",{htmlFor:"jointSelect",children:"Select Joint:"}),o.jsx("select",{id:"jointSelect",value:p,onChange:u=>r(parseInt(u.target.value)),children:[1,2,3,4,5,6,7].map(u=>o.jsxs("option",{value:u,children:["Joint ",u]},u))})]}),o.jsxs("div",{className:"pid-controls",children:[o.jsx("h3",{children:"PID Control"}),o.jsxs(zi,{children:[o.jsx("h4",{children:"Current Gains"}),C?o.jsxs(Hi,{children:[o.jsxs(Ke,{children:[o.jsx("span",{children:"Angle Kp:"}),o.jsx(Ge,{children:C.angKp})]}),o.jsxs(Ke,{children:[o.jsx("span",{children:"Angle Ki:"}),o.jsx(Ge,{children:C.angKi})]}),o.jsxs(Ke,{children:[o.jsx("span",{children:"Speed Kp:"}),o.jsx(Ge,{children:C.spdKp})]}),o.jsxs(Ke,{children:[o.jsx("span",{children:"Speed Ki:"}),o.jsx(Ge,{children:C.spdKi})]}),o.jsxs(Ke,{children:[o.jsx("span",{children:"IQ Kp:"}),o.jsx(Ge,{children:C.iqKp})]}),o.jsxs(Ke,{children:[o.jsx("span",{children:"IQ Ki:"}),o.jsx(Ge,{children:C.iqKi})]})]}):o.jsx("p",{children:'No gains data available. Click "Read PID Gains" to fetch current values.'})]}),o.jsxs("div",{className:"pid-inputs",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"angKp",children:"Angle Kp:"}),o.jsx("input",{type:"number",id:"angKp",value:a.angKp,onChange:u=>T("angKp",u.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"angKi",children:"Angle Ki:"}),o.jsx("input",{type:"number",id:"angKi",value:a.angKi,onChange:u=>T("angKi",u.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"spdKp",children:"Speed Kp:"}),o.jsx("input",{type:"number",id:"spdKp",value:a.spdKp,onChange:u=>T("spdKp",u.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"spdKi",children:"Speed Ki:"}),o.jsx("input",{type:"number",id:"spdKi",value:a.spdKi,onChange:u=>T("spdKi",u.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"iqKp",children:"IQ Kp:"}),o.jsx("input",{type:"number",id:"iqKp",value:a.iqKp,onChange:u=>T("iqKp",u.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"iqKi",children:"IQ Ki:"}),o.jsx("input",{type:"number",id:"iqKi",value:a.iqKi,onChange:u=>T("iqKi",u.target.value)})]})]}),o.jsxs("div",{className:"pid-actions",children:[o.jsx("button",{onClick:K,children:"Read PID Gains"}),o.jsx("button",{onClick:H,children:"Write Gains to RAM"}),o.jsx("button",{onClick:M,children:"Write Gains to ROM"})]})]}),o.jsxs("div",{className:"encoder-controls",children:[o.jsx("h3",{children:"Encoder"}),o.jsxs("div",{className:"encoder-input",children:[o.jsx("label",{htmlFor:"encoderValue",children:"Encoder Value:"}),o.jsx("input",{type:"number",id:"encoderValue",value:f,onChange:u=>d(parseInt(u.target.value)||0)})]}),o.jsxs("div",{className:"encoder-actions",children:[o.jsx("button",{onClick:G,children:"Read Encoder"}),o.jsx("button",{onClick:b,children:"Set Encoder Zero"}),o.jsx("button",{onClick:X,children:"Write Current Pos as Zero"})]})]}),o.jsxs("div",{className:"accel-controls",children:[o.jsx("h3",{children:"Acceleration"}),o.jsxs("div",{className:"accel-input",children:[o.jsx("label",{htmlFor:"accelVal",children:"Acceleration Value (1 dps^2):"}),o.jsx("input",{type:"number",id:"accelVal",value:x,onChange:u=>j(parseInt(u.target.value)||0)})]}),o.jsxs("div",{className:"accel-actions",children:[o.jsx("button",{onClick:V,children:"Write Acceleration"}),o.jsx("button",{onClick:L,children:"Read Acceleration"})]})]})]})},Wi=()=>o.jsxs(xe,{sx:{p:3},children:[o.jsx("h1",{children:"Armatron Motor Tuner"}),o.jsx(Bi,{}),o.jsx("div",{id:"cardsGrid",className:"cards-grid",children:[1,2,3,4,5,6,7].map(p=>o.jsx(Gi,{jointId:p},p))}),o.jsx($i,{})]});class Yi extends mt{constructor(r){super(r)}load(r,a,c,f){const d=this,x=new pn(this.manager);x.setPath(this.path),x.setResponseType("arraybuffer"),x.setRequestHeader(this.requestHeader),x.setWithCredentials(this.withCredentials),x.load(r,function(j){try{a(d.parse(j))}catch(C){f?f(C):console.error(C),d.manager.itemError(r)}},c,f)}parse(r){function a(v){const T=new DataView(v),K=32/8*3+32/8*3*3+16/8,H=T.getUint32(80,!0);if(80+32/8+H*K===T.byteLength)return!0;const G=[115,111,108,105,100];for(let b=0;b<5;b++)if(c(G,T,b))return!1;return!0}function c(v,T,K){for(let H=0,M=v.length;H<M;H++)if(v[H]!==T.getUint8(K+H))return!1;return!0}function f(v){const T=new DataView(v),K=T.getUint32(80,!0);let H,M,G,b=!1,X,V,L,u,k;for(let I=0;I<70;I++)T.getUint32(I,!1)==1129270351&&T.getUint8(I+4)==82&&T.getUint8(I+5)==61&&(b=!0,X=new Float32Array(K*3*3),V=T.getUint8(I+6)/255,L=T.getUint8(I+7)/255,u=T.getUint8(I+8)/255,k=T.getUint8(I+9)/255);const g=84,U=12*4+2,z=new gt,_=new Float32Array(K*3*3),N=new Float32Array(K*3*3),Y=new bt;for(let I=0;I<K;I++){const P=g+I*U,te=T.getFloat32(P,!0),ge=T.getFloat32(P+4,!0),he=T.getFloat32(P+8,!0);if(b){const w=T.getUint16(P+48,!0);w&32768?(H=V,M=L,G=u):(H=(w&31)/31,M=(w>>5&31)/31,G=(w>>10&31)/31)}for(let w=1;w<=3;w++){const ce=P+w*12,ee=I*3*3+(w-1)*3;_[ee]=T.getFloat32(ce,!0),_[ee+1]=T.getFloat32(ce+4,!0),_[ee+2]=T.getFloat32(ce+8,!0),N[ee]=te,N[ee+1]=ge,N[ee+2]=he,b&&(Y.set(H,M,G).convertSRGBToLinear(),X[ee]=Y.r,X[ee+1]=Y.g,X[ee+2]=Y.b)}}return z.setAttribute("position",new dt(_,3)),z.setAttribute("normal",new dt(N,3)),b&&(z.setAttribute("color",new dt(X,3)),z.hasColors=!0,z.alpha=k),z}function d(v){const T=new gt,K=/solid([\s\S]*?)endsolid/g,H=/facet([\s\S]*?)endfacet/g,M=/solid\s(.+)/;let G=0;const b=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,X=new RegExp("vertex"+b+b+b,"g"),V=new RegExp("normal"+b+b+b,"g"),L=[],u=[],k=[],g=new be;let U,z=0,_=0,N=0;for(;(U=K.exec(v))!==null;){_=N;const Y=U[0],I=(U=M.exec(Y))!==null?U[1]:"";for(k.push(I);(U=H.exec(Y))!==null;){let ge=0,he=0;const w=U[0];for(;(U=V.exec(w))!==null;)g.x=parseFloat(U[1]),g.y=parseFloat(U[2]),g.z=parseFloat(U[3]),he++;for(;(U=X.exec(w))!==null;)L.push(parseFloat(U[1]),parseFloat(U[2]),parseFloat(U[3])),u.push(g.x,g.y,g.z),ge++,N++;he!==1&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+G),ge!==3&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+G),G++}const P=_,te=N-_;T.userData.groupNames=k,T.addGroup(P,te,z),z++}return T.setAttribute("position",new Ee(L,3)),T.setAttribute("normal",new Ee(u,3)),T}function x(v){return typeof v!="string"?new TextDecoder().decode(v):v}function j(v){if(typeof v=="string"){const T=new Uint8Array(v.length);for(let K=0;K<v.length;K++)T[K]=v.charCodeAt(K)&255;return T.buffer||T}else return v}const C=j(r);return a(C)?f(C):d(x(r))}}class rn extends Is{constructor(r){super(r)}parse(r){function a(w){switch(w.image_type){case H:case b:if(w.colormap_length>256||w.colormap_size!==24||w.colormap_type!==1)throw new Error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case M:case G:case X:case V:if(w.colormap_type)throw new Error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case K:throw new Error("THREE.TGALoader: No data.");default:throw new Error("THREE.TGALoader: Invalid type "+w.image_type)}if(w.width<=0||w.height<=0)throw new Error("THREE.TGALoader: Invalid image size.");if(w.pixel_size!==8&&w.pixel_size!==16&&w.pixel_size!==24&&w.pixel_size!==32)throw new Error("THREE.TGALoader: Invalid pixel size "+w.pixel_size)}function c(w,ce,ee,re,pe){let ie,ae;const Z=ee.pixel_size>>3,Q=ee.width*ee.height*Z;if(ce&&(ae=pe.subarray(re,re+=ee.colormap_length*(ee.colormap_size>>3))),w){ie=new Uint8Array(Q);let J,E,$,le=0;const Ce=new Uint8Array(Z);for(;le<Q;)if(J=pe[re++],E=(J&127)+1,J&128){for($=0;$<Z;++$)Ce[$]=pe[re++];for($=0;$<E;++$)ie.set(Ce,le+$*Z);le+=Z*E}else{for(E*=Z,$=0;$<E;++$)ie[le+$]=pe[re++];le+=E}}else ie=pe.subarray(re,re+=ce?ee.width*ee.height:Q);return{pixel_data:ie,palettes:ae}}function f(w,ce,ee,re,pe,ie,ae,Z,Q){const J=Q;let E,$=0,le,Ce;const Oe=Y.width;for(Ce=ce;Ce!==re;Ce+=ee)for(le=pe;le!==ae;le+=ie,$++)E=Z[$],w[(le+Oe*Ce)*4+3]=255,w[(le+Oe*Ce)*4+2]=J[E*3+0],w[(le+Oe*Ce)*4+1]=J[E*3+1],w[(le+Oe*Ce)*4+0]=J[E*3+2];return w}function d(w,ce,ee,re,pe,ie,ae,Z){let Q,J=0,E,$;const le=Y.width;for($=ce;$!==re;$+=ee)for(E=pe;E!==ae;E+=ie,J+=2)Q=Z[J+0]+(Z[J+1]<<8),w[(E+le*$)*4+0]=(Q&31744)>>7,w[(E+le*$)*4+1]=(Q&992)>>2,w[(E+le*$)*4+2]=(Q&31)<<3,w[(E+le*$)*4+3]=Q&32768?0:255;return w}function x(w,ce,ee,re,pe,ie,ae,Z){let Q=0,J,E;const $=Y.width;for(E=ce;E!==re;E+=ee)for(J=pe;J!==ae;J+=ie,Q+=3)w[(J+$*E)*4+3]=255,w[(J+$*E)*4+2]=Z[Q+0],w[(J+$*E)*4+1]=Z[Q+1],w[(J+$*E)*4+0]=Z[Q+2];return w}function j(w,ce,ee,re,pe,ie,ae,Z){let Q=0,J,E;const $=Y.width;for(E=ce;E!==re;E+=ee)for(J=pe;J!==ae;J+=ie,Q+=4)w[(J+$*E)*4+2]=Z[Q+0],w[(J+$*E)*4+1]=Z[Q+1],w[(J+$*E)*4+0]=Z[Q+2],w[(J+$*E)*4+3]=Z[Q+3];return w}function C(w,ce,ee,re,pe,ie,ae,Z){let Q,J=0,E,$;const le=Y.width;for($=ce;$!==re;$+=ee)for(E=pe;E!==ae;E+=ie,J++)Q=Z[J],w[(E+le*$)*4+0]=Q,w[(E+le*$)*4+1]=Q,w[(E+le*$)*4+2]=Q,w[(E+le*$)*4+3]=255;return w}function v(w,ce,ee,re,pe,ie,ae,Z){let Q=0,J,E;const $=Y.width;for(E=ce;E!==re;E+=ee)for(J=pe;J!==ae;J+=ie,Q+=2)w[(J+$*E)*4+0]=Z[Q+0],w[(J+$*E)*4+1]=Z[Q+0],w[(J+$*E)*4+2]=Z[Q+0],w[(J+$*E)*4+3]=Z[Q+1];return w}function T(w,ce,ee,re,pe){let ie,ae,Z,Q,J,E;switch((Y.flags&L)>>u){default:case U:ie=0,Z=1,J=ce,ae=0,Q=1,E=ee;break;case k:ie=0,Z=1,J=ce,ae=ee-1,Q=-1,E=-1;break;case z:ie=ce-1,Z=-1,J=-1,ae=0,Q=1,E=ee;break;case g:ie=ce-1,Z=-1,J=-1,ae=ee-1,Q=-1,E=-1;break}if(te)switch(Y.pixel_size){case 8:C(w,ae,Q,E,ie,Z,J,re);break;case 16:v(w,ae,Q,E,ie,Z,J,re);break;default:throw new Error("THREE.TGALoader: Format not supported.")}else switch(Y.pixel_size){case 8:f(w,ae,Q,E,ie,Z,J,re,pe);break;case 16:d(w,ae,Q,E,ie,Z,J,re);break;case 24:x(w,ae,Q,E,ie,Z,J,re);break;case 32:j(w,ae,Q,E,ie,Z,J,re);break;default:throw new Error("THREE.TGALoader: Format not supported.")}return w}const K=0,H=1,M=2,G=3,b=9,X=10,V=11,L=48,u=4,k=0,g=1,U=2,z=3;if(r.length<19)throw new Error("THREE.TGALoader: Not enough data to contain header.");let _=0;const N=new Uint8Array(r),Y={id_length:N[_++],colormap_type:N[_++],image_type:N[_++],colormap_index:N[_++]|N[_++]<<8,colormap_length:N[_++]|N[_++]<<8,colormap_size:N[_++],origin:[N[_++]|N[_++]<<8,N[_++]|N[_++]<<8],width:N[_++]|N[_++]<<8,height:N[_++]|N[_++]<<8,pixel_size:N[_++],flags:N[_++]};if(a(Y),Y.id_length+_>r.length)throw new Error("THREE.TGALoader: No data.");_+=Y.id_length;let I=!1,P=!1,te=!1;switch(Y.image_type){case b:I=!0,P=!0;break;case H:P=!0;break;case X:I=!0;break;case M:break;case V:I=!0,te=!0;break;case G:te=!0;break}const ge=new Uint8Array(Y.width*Y.height*4),he=c(I,P,Y,_,N);return T(ge,Y.width,Y.height,he.pixel_data,he.palettes),{data:ge,width:Y.width,height:Y.height,flipY:!0,generateMipmaps:!0,minFilter:Os}}}class Qi extends mt{load(r,a,c,f){const d=this,x=d.path===""?fn.extractUrlBase(r):d.path,j=new pn(d.manager);j.setPath(d.path),j.setRequestHeader(d.requestHeader),j.setWithCredentials(d.withCredentials),j.load(r,function(C){try{a(d.parse(C,x))}catch(v){f?f(v):console.error(v),d.manager.itemError(r)}},c,f)}parse(r,a){function c(t,e){const s=[],n=t.childNodes;for(let i=0,l=n.length;i<l;i++){const h=n[i];h.nodeName===e&&s.push(h)}return s}function f(t){if(t.length===0)return[];const e=t.trim().split(/\s+/),s=new Array(e.length);for(let n=0,i=e.length;n<i;n++)s[n]=e[n];return s}function d(t){if(t.length===0)return[];const e=t.trim().split(/\s+/),s=new Array(e.length);for(let n=0,i=e.length;n<i;n++)s[n]=parseFloat(e[n]);return s}function x(t){if(t.length===0)return[];const e=t.trim().split(/\s+/),s=new Array(e.length);for(let n=0,i=e.length;n<i;n++)s[n]=parseInt(e[n]);return s}function j(t){return t.substring(1)}function C(){return"three_default_"+Ls++}function v(t){return Object.keys(t).length===0}function T(t){return{unit:K(c(t,"unit")[0]),upAxis:H(c(t,"up_axis")[0])}}function K(t){return t!==void 0&&t.hasAttribute("meter")===!0?parseFloat(t.getAttribute("meter")):1}function H(t){return t!==void 0?t.textContent:"Y_UP"}function M(t,e,s,n){const i=c(t,e)[0];if(i!==void 0){const l=c(i,s);for(let h=0;h<l.length;h++)n(l[h])}}function G(t,e){for(const s in t){const n=t[s];n.build=e(t[s])}}function b(t,e){return t.build!==void 0||(t.build=e(t)),t.build}function X(t){const e={sources:{},samplers:{},channels:{}};let s=!1;for(let n=0,i=t.childNodes.length;n<i;n++){const l=t.childNodes[n];if(l.nodeType!==1)continue;let h;switch(l.nodeName){case"source":h=l.getAttribute("id"),e.sources[h]=rt(l);break;case"sampler":h=l.getAttribute("id"),e.samplers[h]=V(l);break;case"channel":h=l.getAttribute("target"),e.channels[h]=L(l);break;case"animation":X(l),s=!0;break;default:console.log(l)}}s===!1&&(W.animations[t.getAttribute("id")||Be.generateUUID()]=e)}function V(t){const e={inputs:{}};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"input":const l=j(i.getAttribute("source")),h=i.getAttribute("semantic");e.inputs[h]=l;break}}return e}function L(t){const e={};let n=t.getAttribute("target").split("/");const i=n.shift();let l=n.shift();const h=l.indexOf("(")!==-1,S=l.indexOf(".")!==-1;if(S)n=l.split("."),l=n.shift(),e.member=n.shift();else if(h){const y=l.split("(");l=y.shift();for(let A=0;A<y.length;A++)y[A]=parseInt(y[A].replace(/\)/,""));e.indices=y}return e.id=i,e.sid=l,e.arraySyntax=h,e.memberSyntax=S,e.sampler=j(t.getAttribute("source")),e}function u(t){const e=[],s=t.channels,n=t.samplers,i=t.sources;for(const l in s)if(s.hasOwnProperty(l)){const h=s[l],S=n[h.sampler],y=S.inputs.INPUT,A=S.inputs.OUTPUT,D=i[y],m=i[A],F=g(h,D,m);Y(F,e)}return e}function k(t){return b(W.animations[t],u)}function g(t,e,s){const n=W.nodes[t.id],i=Ue(n.id),l=n.transforms[t.sid],h=n.matrix.clone().transpose();let S,y,A,D,m,F;const R={};switch(l){case"matrix":for(A=0,D=e.array.length;A<D;A++)if(S=e.array[A],y=A*s.stride,R[S]===void 0&&(R[S]={}),t.arraySyntax===!0){const ue=s.array[y],oe=t.indices[0]+4*t.indices[1];R[S][oe]=ue}else for(m=0,F=s.stride;m<F;m++)R[S][m]=s.array[y+m];break;case"translate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',l);break;case"rotate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',l);break;case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',l);break}const q=U(R,h);return{name:i.uuid,keyframes:q}}function U(t,e){const s=[];for(const i in t)s.push({time:parseFloat(i),value:t[i]});s.sort(n);for(let i=0;i<16;i++)I(s,i,e.elements[i]);return s;function n(i,l){return i.time-l.time}}const z=new be,_=new be,N=new kt;function Y(t,e){const s=t.keyframes,n=t.name,i=[],l=[],h=[],S=[];for(let y=0,A=s.length;y<A;y++){const D=s[y],m=D.time,F=D.value;we.fromArray(F).transpose(),we.decompose(z,N,_),i.push(m),l.push(z.x,z.y,z.z),h.push(N.x,N.y,N.z,N.w),S.push(_.x,_.y,_.z)}return l.length>0&&e.push(new en(n+".position",i,l)),h.length>0&&e.push(new Ws(n+".quaternion",i,h)),S.length>0&&e.push(new en(n+".scale",i,S)),e}function I(t,e,s){let n,i=!0,l,h;for(l=0,h=t.length;l<h;l++)n=t[l],n.value[e]===void 0?n.value[e]=null:i=!1;if(i===!0)for(l=0,h=t.length;l<h;l++)n=t[l],n.value[e]=s;else P(t,e)}function P(t,e){let s,n;for(let i=0,l=t.length;i<l;i++){const h=t[i];if(h.value[e]===null){if(s=te(t,i,e),n=ge(t,i,e),s===null){h.value[e]=n.value[e];continue}if(n===null){h.value[e]=s.value[e];continue}he(h,s,n,e)}}}function te(t,e,s){for(;e>=0;){const n=t[e];if(n.value[s]!==null)return n;e--}return null}function ge(t,e,s){for(;e<t.length;){const n=t[e];if(n.value[s]!==null)return n;e++}return null}function he(t,e,s,n){if(s.time-e.time===0){t.value[n]=e.value[n];return}t.value[n]=(t.time-e.time)*(s.value[n]-e.value[n])/(s.time-e.time)+e.value[n]}function w(t){const e={name:t.getAttribute("id")||"default",start:parseFloat(t.getAttribute("start")||0),end:parseFloat(t.getAttribute("end")||0),animations:[]};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"instance_animation":e.animations.push(j(i.getAttribute("url")));break}}W.clips[t.getAttribute("id")]=e}function ce(t){const e=[],s=t.name,n=t.end-t.start||-1,i=t.animations;for(let l=0,h=i.length;l<h;l++){const S=k(i[l]);for(let y=0,A=S.length;y<A;y++)e.push(S[y])}return new Qt(s,n,e)}function ee(t){return b(W.clips[t],ce)}function re(t){const e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"skin":e.id=j(i.getAttribute("source")),e.skin=pe(i);break;case"morph":e.id=j(i.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.");break}}W.controllers[t.getAttribute("id")]=e}function pe(t){const e={sources:{}};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"bind_shape_matrix":e.bindShapeMatrix=d(i.textContent);break;case"source":const l=i.getAttribute("id");e.sources[l]=rt(i);break;case"joints":e.joints=ie(i);break;case"vertex_weights":e.vertexWeights=ae(i);break}}return e}function ie(t){const e={inputs:{}};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"input":const l=i.getAttribute("semantic"),h=j(i.getAttribute("source"));e.inputs[l]=h;break}}return e}function ae(t){const e={inputs:{}};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"input":const l=i.getAttribute("semantic"),h=j(i.getAttribute("source")),S=parseInt(i.getAttribute("offset"));e.inputs[l]={id:h,offset:S};break;case"vcount":e.vcount=x(i.textContent);break;case"v":e.v=x(i.textContent);break}}return e}function Z(t){const e={id:t.id},s=W.geometries[e.id];return t.skin!==void 0&&(e.skin=Q(t.skin),s.sources.skinIndices=e.skin.indices,s.sources.skinWeights=e.skin.weights),e}function Q(t){const s={joints:[],indices:{array:[],stride:4},weights:{array:[],stride:4}},n=t.sources,i=t.vertexWeights,l=i.vcount,h=i.v,S=i.inputs.JOINT.offset,y=i.inputs.WEIGHT.offset,A=t.sources[t.joints.inputs.JOINT],D=t.sources[t.joints.inputs.INV_BIND_MATRIX],m=n[i.inputs.WEIGHT.id].array;let F=0,R,q,O;for(R=0,O=l.length;R<O;R++){const oe=l[R],ne=[];for(q=0;q<oe;q++){const se=h[F+S],Se=h[F+y],ye=m[Se];ne.push({index:se,weight:ye}),F+=2}for(ne.sort(ue),q=0;q<4;q++){const se=ne[q];se!==void 0?(s.indices.array.push(se.index),s.weights.array.push(se.weight)):(s.indices.array.push(0),s.weights.array.push(0))}}for(t.bindShapeMatrix?s.bindMatrix=new Te().fromArray(t.bindShapeMatrix).transpose():s.bindMatrix=new Te().identity(),R=0,O=A.array.length;R<O;R++){const oe=A.array[R],ne=new Te().fromArray(D.array,R*D.stride).transpose();s.joints.push({name:oe,boneInverse:ne})}return s;function ue(oe,ne){return ne.weight-oe.weight}}function J(t){return b(W.controllers[t],Z)}function E(t){const e={init_from:c(t,"init_from")[0].textContent};W.images[t.getAttribute("id")]=e}function $(t){return t.build!==void 0?t.build:t.init_from}function le(t){const e=W.images[t];return e!==void 0?b(e,$):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",t),null)}function Ce(t){const e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"profile_COMMON":e.profile=Oe(i);break}}W.effects[t.getAttribute("id")]=e}function Oe(t){const e={surfaces:{},samplers:{}};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"newparam":Ln(i,e);break;case"technique":e.technique=Dn(i);break;case"extra":e.extra=St(i);break}}return e}function Ln(t,e){const s=t.getAttribute("sid");for(let n=0,i=t.childNodes.length;n<i;n++){const l=t.childNodes[n];if(l.nodeType===1)switch(l.nodeName){case"surface":e.surfaces[s]=Pn(l);break;case"sampler2D":e.samplers[s]=Fn(l);break}}}function Pn(t){const e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"init_from":e.init_from=i.textContent;break}}return e}function Fn(t){const e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"source":e.source=i.textContent;break}}return e}function Dn(t){const e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"constant":case"lambert":case"blinn":case"phong":e.type=i.nodeName,e.parameters=In(i);break;case"extra":e.extra=St(i);break}}return e}function In(t){const e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":e[i.nodeName]=Tt(i);break;case"transparent":e[i.nodeName]={opaque:i.hasAttribute("opaque")?i.getAttribute("opaque"):"A_ONE",data:Tt(i)};break}}return e}function Tt(t){const e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"color":e[i.nodeName]=d(i.textContent);break;case"float":e[i.nodeName]=parseFloat(i.textContent);break;case"texture":e[i.nodeName]={id:i.getAttribute("texture"),extra:_t(i)};break}}return e}function _t(t){const e={technique:{}};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"extra":On(i,e);break}}return e}function On(t,e){for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"technique":Vn(i,e);break}}}function Vn(t,e){for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":e.technique[i.nodeName]=parseFloat(i.textContent);break;case"wrapU":case"wrapV":i.textContent.toUpperCase()==="TRUE"?e.technique[i.nodeName]=1:i.textContent.toUpperCase()==="FALSE"?e.technique[i.nodeName]=0:e.technique[i.nodeName]=parseInt(i.textContent);break;case"bump":e[i.nodeName]=Et(i);break}}}function St(t){const e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"technique":e.technique=Un(i);break}}return e}function Un(t){const e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"double_sided":e[i.nodeName]=parseInt(i.textContent);break;case"bump":e[i.nodeName]=Et(i);break}}return e}function Et(t){const e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"texture":e[i.nodeName]={id:i.getAttribute("texture"),texcoord:i.getAttribute("texcoord"),extra:_t(i)};break}}return e}function Rt(t){return t}function qn(t){return b(W.effects[t],Rt)}function Kn(t){const e={name:t.getAttribute("name")};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"instance_effect":e.url=j(i.getAttribute("url"));break}}W.materials[t.getAttribute("id")]=e}function Gn(t){let e,s=t.slice((t.lastIndexOf(".")-1>>>0)+2);switch(s=s.toLowerCase(),s){case"tga":e=lt;break;default:e=Ht}return e}function Mt(t){const e=qn(t.url),s=e.profile.technique;let n;switch(s.type){case"phong":case"blinn":n=new He;break;case"lambert":n=new Us;break;default:n=new Yt;break}n.name=t.name||"";function i(y,A=null){const D=e.profile.samplers[y.id];let m=null;if(D!==void 0){const F=e.profile.surfaces[D.source];m=le(F.init_from)}else console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),m=le(y.id);if(m!==null){const F=Gn(m);if(F!==void 0){const R=F.load(m),q=y.extra;if(q!==void 0&&q.technique!==void 0&&v(q.technique)===!1){const O=q.technique;R.wrapS=O.wrapU?Qe:nn,R.wrapT=O.wrapV?Qe:nn,R.offset.set(O.offsetU||0,O.offsetV||0),R.repeat.set(O.repeatU||1,O.repeatV||1)}else R.wrapS=Qe,R.wrapT=Qe;return A!==null&&(R.colorSpace=A),R}else return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",m),null}else return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",y.id),null}const l=s.parameters;for(const y in l){const A=l[y];switch(y){case"diffuse":A.color&&n.color.fromArray(A.color),A.texture&&(n.map=i(A.texture,nt));break;case"specular":A.color&&n.specular&&n.specular.fromArray(A.color),A.texture&&(n.specularMap=i(A.texture));break;case"bump":A.texture&&(n.normalMap=i(A.texture));break;case"ambient":A.texture&&(n.lightMap=i(A.texture,nt));break;case"shininess":A.float&&n.shininess&&(n.shininess=A.float);break;case"emission":A.color&&n.emissive&&n.emissive.fromArray(A.color),A.texture&&(n.emissiveMap=i(A.texture,nt));break}}n.color.convertSRGBToLinear(),n.specular&&n.specular.convertSRGBToLinear(),n.emissive&&n.emissive.convertSRGBToLinear();let h=l.transparent,S=l.transparency;if(S===void 0&&h&&(S={float:1}),h===void 0&&S&&(h={opaque:"A_ONE",data:{color:[1,1,1,1]}}),h&&S)if(h.data.texture)n.transparent=!0;else{const y=h.data.color;switch(h.opaque){case"A_ONE":n.opacity=y[3]*S.float;break;case"RGB_ZERO":n.opacity=1-y[0]*S.float;break;case"A_ZERO":n.opacity=1-y[3]*S.float;break;case"RGB_ONE":n.opacity=y[0]*S.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',h.opaque)}n.opacity<1&&(n.transparent=!0)}if(s.extra!==void 0&&s.extra.technique!==void 0){const y=s.extra.technique;for(const A in y){const D=y[A];switch(A){case"double_sided":n.side=D===1?Ks:Gs;break;case"bump":n.normalMap=i(D.texture),n.normalScale=new qs(1,1);break}}}return n}function Jn(t){return b(W.materials[t],Mt)}function Bn(t){const e={name:t.getAttribute("name")};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"optics":e.optics=zn(i);break}}W.cameras[t.getAttribute("id")]=e}function zn(t){for(let e=0;e<t.childNodes.length;e++){const s=t.childNodes[e];switch(s.nodeName){case"technique_common":return Hn(s)}}return{}}function Hn(t){const e={};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];switch(n.nodeName){case"perspective":case"orthographic":e.technique=n.nodeName,e.parameters=$n(n);break}}return e}function $n(t){const e={};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];switch(n.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":e[n.nodeName]=parseFloat(n.textContent);break}}return e}function Lt(t){let e;switch(t.optics.technique){case"perspective":e=new Xt(t.optics.parameters.yfov,t.optics.parameters.aspect_ratio,t.optics.parameters.znear,t.optics.parameters.zfar);break;case"orthographic":let s=t.optics.parameters.ymag,n=t.optics.parameters.xmag;const i=t.optics.parameters.aspect_ratio;n=n===void 0?s*i:n,s=s===void 0?n/i:s,n*=.5,s*=.5,e=new Js(-n,n,s,-s,t.optics.parameters.znear,t.optics.parameters.zfar);break;default:e=new Xt;break}return e.name=t.name||"",e}function Wn(t){const e=W.cameras[t];return e!==void 0?b(e,Lt):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",t),null)}function Yn(t){let e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"technique_common":e=Qn(i);break}}W.lights[t.getAttribute("id")]=e}function Qn(t){const e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"directional":case"point":case"spot":case"ambient":e.technique=i.nodeName,e.parameters=Xn(i)}}return e}function Xn(t){const e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"color":const l=d(i.textContent);e.color=new bt().fromArray(l).convertSRGBToLinear();break;case"falloff_angle":e.falloffAngle=parseFloat(i.textContent);break;case"quadratic_attenuation":const h=parseFloat(i.textContent);e.distance=h?Math.sqrt(1/h):0;break}}return e}function Pt(t){let e;switch(t.technique){case"directional":e=new $s;break;case"point":e=new Hs;break;case"spot":e=new zs;break;case"ambient":e=new Bs;break}return t.parameters.color&&e.color.copy(t.parameters.color),t.parameters.distance&&(e.distance=t.parameters.distance),e}function Zn(t){const e=W.lights[t];return e!==void 0?b(e,Pt):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",t),null)}function es(t){const e={name:t.getAttribute("name"),sources:{},vertices:{},primitives:[]},s=c(t,"mesh")[0];if(s!==void 0){for(let n=0;n<s.childNodes.length;n++){const i=s.childNodes[n];if(i.nodeType!==1)continue;const l=i.getAttribute("id");switch(i.nodeName){case"source":e.sources[l]=rt(i);break;case"vertices":e.vertices=ts(i);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",i.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":e.primitives.push(ns(i));break;default:console.log(i)}}W.geometries[t.getAttribute("id")]=e}}function rt(t){const e={array:[],stride:3};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType===1)switch(n.nodeName){case"float_array":e.array=d(n.textContent);break;case"Name_array":e.array=f(n.textContent);break;case"technique_common":const i=c(n,"accessor")[0];i!==void 0&&(e.stride=parseInt(i.getAttribute("stride")));break}}return e}function ts(t){const e={};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];n.nodeType===1&&(e[n.getAttribute("semantic")]=j(n.getAttribute("source")))}return e}function ns(t){const e={type:t.nodeName,material:t.getAttribute("material"),count:parseInt(t.getAttribute("count")),inputs:{},stride:0,hasUV:!1};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"input":const l=j(i.getAttribute("source")),h=i.getAttribute("semantic"),S=parseInt(i.getAttribute("offset")),y=parseInt(i.getAttribute("set")),A=y>0?h+y:h;e.inputs[A]={id:l,offset:S},e.stride=Math.max(e.stride,S+1),h==="TEXCOORD"&&(e.hasUV=!0);break;case"vcount":e.vcount=x(i.textContent);break;case"p":e.p=x(i.textContent);break}}return e}function ss(t){const e={};for(let s=0;s<t.length;s++){const n=t[s];e[n.type]===void 0&&(e[n.type]=[]),e[n.type].push(n)}return e}function is(t){let e=0;for(let s=0,n=t.length;s<n;s++)t[s].hasUV===!0&&e++;e>0&&e<t.length&&(t.uvsNeedsFix=!0)}function Ft(t){const e={},s=t.sources,n=t.vertices,i=t.primitives;if(i.length===0)return{};const l=ss(i);for(const h in l){const S=l[h];is(S),e[h]=os(S,s,n)}return e}function os(t,e,s){const n={},i={array:[],stride:0},l={array:[],stride:0},h={array:[],stride:0},S={array:[],stride:0},y={array:[],stride:0},A={array:[],stride:4},D={array:[],stride:4},m=new gt,F=[];let R=0;for(let q=0;q<t.length;q++){const O=t[q],ue=O.inputs;let oe=0;switch(O.type){case"lines":case"linestrips":oe=O.count*2;break;case"triangles":oe=O.count*3;break;case"polylist":for(let ne=0;ne<O.count;ne++){const se=O.vcount[ne];switch(se){case 3:oe+=3;break;case 4:oe+=6;break;default:oe+=(se-2)*3;break}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",O.type)}m.addGroup(R,oe,q),R+=oe,O.material&&F.push(O.material);for(const ne in ue){const se=ue[ne];switch(ne){case"VERTEX":for(const Se in s){const ye=s[Se];switch(Se){case"POSITION":const qe=i.array.length;if(ve(O,e[ye],se.offset,i.array),i.stride=e[ye].stride,e.skinWeights&&e.skinIndices&&(ve(O,e.skinIndices,se.offset,A.array),ve(O,e.skinWeights,se.offset,D.array)),O.hasUV===!1&&t.uvsNeedsFix===!0){const Ps=(i.array.length-qe)/i.stride;for(let Wt=0;Wt<Ps;Wt++)h.array.push(0,0)}break;case"NORMAL":ve(O,e[ye],se.offset,l.array),l.stride=e[ye].stride;break;case"COLOR":ve(O,e[ye],se.offset,y.array),y.stride=e[ye].stride;break;case"TEXCOORD":ve(O,e[ye],se.offset,h.array),h.stride=e[ye].stride;break;case"TEXCOORD1":ve(O,e[ye],se.offset,S.array),h.stride=e[ye].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',Se)}}break;case"NORMAL":ve(O,e[se.id],se.offset,l.array),l.stride=e[se.id].stride;break;case"COLOR":ve(O,e[se.id],se.offset,y.array,!0),y.stride=e[se.id].stride;break;case"TEXCOORD":ve(O,e[se.id],se.offset,h.array),h.stride=e[se.id].stride;break;case"TEXCOORD1":ve(O,e[se.id],se.offset,S.array),S.stride=e[se.id].stride;break}}}return i.array.length>0&&m.setAttribute("position",new Ee(i.array,i.stride)),l.array.length>0&&m.setAttribute("normal",new Ee(l.array,l.stride)),y.array.length>0&&m.setAttribute("color",new Ee(y.array,y.stride)),h.array.length>0&&m.setAttribute("uv",new Ee(h.array,h.stride)),S.array.length>0&&m.setAttribute("uv1",new Ee(S.array,S.stride)),A.array.length>0&&m.setAttribute("skinIndex",new Ee(A.array,A.stride)),D.array.length>0&&m.setAttribute("skinWeight",new Ee(D.array,D.stride)),n.data=m,n.type=t[0].type,n.materialKeys=F,n}function ve(t,e,s,n,i=!1){const l=t.p,h=t.stride,S=t.vcount;function y(m){let F=l[m+s]*D;const R=F+D;for(;F<R;F++)n.push(A[F]);if(i){const q=n.length-D-1;$e.setRGB(n[q+0],n[q+1],n[q+2]).convertSRGBToLinear(),n[q+0]=$e.r,n[q+1]=$e.g,n[q+2]=$e.b}}const A=e.array,D=e.stride;if(t.vcount!==void 0){let m=0;for(let F=0,R=S.length;F<R;F++){const q=S[F];if(q===4){const O=m+h*0,ue=m+h*1,oe=m+h*2,ne=m+h*3;y(O),y(ue),y(ne),y(ue),y(oe),y(ne)}else if(q===3){const O=m+h*0,ue=m+h*1,oe=m+h*2;y(O),y(ue),y(oe)}else if(q>4)for(let O=1,ue=q-2;O<=ue;O++){const oe=m+h*0,ne=m+h*O,se=m+h*(O+1);y(oe),y(ne),y(se)}m+=h*q}}else for(let m=0,F=l.length;m<F;m+=h)y(m)}function Dt(t){return b(W.geometries[t],Ft)}function rs(t){const e={name:t.getAttribute("name")||"",joints:{},links:[]};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType===1)switch(n.nodeName){case"technique_common":ls(n,e);break}}W.kinematicsModels[t.getAttribute("id")]=e}function as(t){return t.build!==void 0?t.build:t}function cs(t){return b(W.kinematicsModels[t],as)}function ls(t,e){for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType===1)switch(n.nodeName){case"joint":e.joints[n.getAttribute("sid")]=ds(n);break;case"link":e.links.push(It(n));break}}}function ds(t){let e;for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType===1)switch(n.nodeName){case"prismatic":case"revolute":e=us(n);break}}return e}function us(t){const e={sid:t.getAttribute("sid"),name:t.getAttribute("name")||"",axis:new be,limits:{min:0,max:0},type:t.nodeName,static:!1,zeroPosition:0,middlePosition:0};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType===1)switch(n.nodeName){case"axis":const i=d(n.textContent);e.axis.fromArray(i);break;case"limits":const l=n.getElementsByTagName("max")[0],h=n.getElementsByTagName("min")[0];e.limits.max=parseFloat(l.textContent),e.limits.min=parseFloat(h.textContent);break}}return e.limits.min>=e.limits.max&&(e.static=!0),e.middlePosition=(e.limits.min+e.limits.max)/2,e}function It(t){const e={sid:t.getAttribute("sid"),name:t.getAttribute("name")||"",attachments:[],transforms:[]};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType===1)switch(n.nodeName){case"attachment_full":e.attachments.push(hs(n));break;case"matrix":case"translate":case"rotate":e.transforms.push(Ot(n));break}}return e}function hs(t){const e={joint:t.getAttribute("joint").split("/").pop(),transforms:[],links:[]};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType===1)switch(n.nodeName){case"link":e.links.push(It(n));break;case"matrix":case"translate":case"rotate":e.transforms.push(Ot(n));break}}return e}function Ot(t){const e={type:t.nodeName},s=d(t.textContent);switch(e.type){case"matrix":e.obj=new Te,e.obj.fromArray(s).transpose();break;case"translate":e.obj=new be,e.obj.fromArray(s);break;case"rotate":e.obj=new be,e.obj.fromArray(s),e.angle=Be.degToRad(s[3]);break}return e}function ps(t){const e={name:t.getAttribute("name")||"",rigidBodies:{}};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType===1)switch(n.nodeName){case"rigid_body":e.rigidBodies[n.getAttribute("name")]={},fs(n,e.rigidBodies[n.getAttribute("name")]);break}}W.physicsModels[t.getAttribute("id")]=e}function fs(t,e){for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType===1)switch(n.nodeName){case"technique_common":ms(n,e);break}}}function ms(t,e){for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType===1)switch(n.nodeName){case"inertia":e.inertia=d(n.textContent);break;case"mass":e.mass=d(n.textContent)[0];break}}}function gs(t){const e={bindJointAxis:[]};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType===1)switch(n.nodeName){case"bind_joint_axis":e.bindJointAxis.push(bs(n));break}}W.kinematicsScenes[j(t.getAttribute("url"))]=e}function bs(t){const e={target:t.getAttribute("target").split("/").pop()};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType===1)switch(n.nodeName){case"axis":const i=n.getElementsByTagName("param")[0];e.axis=i.textContent;const l=e.axis.split("inst_").pop().split("axis")[0];e.jointIndex=l.substring(0,l.length-1);break}}return e}function xs(t){return t.build!==void 0?t.build:t}function ys(t){return b(W.kinematicsScenes[t],xs)}function js(){const t=Object.keys(W.kinematicsModels)[0],e=Object.keys(W.kinematicsScenes)[0],s=Object.keys(W.visualScenes)[0];if(t===void 0||e===void 0)return;const n=cs(t),i=ys(e),l=Jt(s),h=i.bindJointAxis,S={};for(let D=0,m=h.length;D<m;D++){const F=h[D],R=fe.querySelector('[sid="'+F.target+'"]');if(R){const q=R.parentElement;y(F.jointIndex,q)}}function y(D,m){const F=m.getAttribute("name"),R=n.joints[D];l.traverse(function(q){q.name===F&&(S[D]={object:q,transforms:ws(m),joint:R,position:R.zeroPosition})})}const A=new Te;$t={joints:n&&n.joints,getJointValue:function(D){const m=S[D];if(m)return m.position;console.warn("THREE.ColladaLoader: Joint "+D+" doesn't exist.")},setJointValue:function(D,m){const F=S[D];if(F){const R=F.joint;if(m>R.limits.max||m<R.limits.min)console.warn("THREE.ColladaLoader: Joint "+D+" value "+m+" outside of limits (min: "+R.limits.min+", max: "+R.limits.max+").");else if(R.static)console.warn("THREE.ColladaLoader: Joint "+D+" is static.");else{const q=F.object,O=R.axis,ue=F.transforms;we.identity();for(let oe=0;oe<ue.length;oe++){const ne=ue[oe];if(ne.sid&&ne.sid.indexOf(D)!==-1)switch(R.type){case"revolute":we.multiply(A.makeRotationAxis(O,Be.degToRad(m)));break;case"prismatic":we.multiply(A.makeTranslation(O.x*m,O.y*m,O.z*m));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+R.type);break}else switch(ne.type){case"matrix":we.multiply(ne.obj);break;case"translate":we.multiply(A.makeTranslation(ne.obj.x,ne.obj.y,ne.obj.z));break;case"scale":we.scale(ne.obj);break;case"rotate":we.multiply(A.makeRotationAxis(ne.obj,ne.angle));break}}q.matrix.copy(we),q.matrix.decompose(q.position,q.quaternion,q.scale),S[D].position=m}}else console.log("THREE.ColladaLoader: "+D+" does not exist.")}}}function ws(t){const e=[],s=fe.querySelector('[id="'+t.id+'"]');for(let n=0;n<s.childNodes.length;n++){const i=s.childNodes[n];if(i.nodeType!==1)continue;let l,h;switch(i.nodeName){case"matrix":l=d(i.textContent);const S=new Te().fromArray(l).transpose();e.push({sid:i.getAttribute("sid"),type:i.nodeName,obj:S});break;case"translate":case"scale":l=d(i.textContent),h=new be().fromArray(l),e.push({sid:i.getAttribute("sid"),type:i.nodeName,obj:h});break;case"rotate":l=d(i.textContent),h=new be().fromArray(l);const y=Be.degToRad(l[3]);e.push({sid:i.getAttribute("sid"),type:i.nodeName,obj:h,angle:y});break}}return e}function ks(t){const e=t.getElementsByTagName("node");for(let s=0;s<e.length;s++){const n=e[s];n.hasAttribute("id")===!1&&n.setAttribute("id",C())}}const we=new Te,Ve=new be;function at(t){const e={name:t.getAttribute("name")||"",type:t.getAttribute("type"),id:t.getAttribute("id"),sid:t.getAttribute("sid"),matrix:new Te,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType!==1)continue;let i;switch(n.nodeName){case"node":e.nodes.push(n.getAttribute("id")),at(n);break;case"instance_camera":e.instanceCameras.push(j(n.getAttribute("url")));break;case"instance_controller":e.instanceControllers.push(Vt(n));break;case"instance_light":e.instanceLights.push(j(n.getAttribute("url")));break;case"instance_geometry":e.instanceGeometries.push(Vt(n));break;case"instance_node":e.instanceNodes.push(j(n.getAttribute("url")));break;case"matrix":i=d(n.textContent),e.matrix.multiply(we.fromArray(i).transpose()),e.transforms[n.getAttribute("sid")]=n.nodeName;break;case"translate":i=d(n.textContent),Ve.fromArray(i),e.matrix.multiply(we.makeTranslation(Ve.x,Ve.y,Ve.z)),e.transforms[n.getAttribute("sid")]=n.nodeName;break;case"rotate":i=d(n.textContent);const l=Be.degToRad(i[3]);e.matrix.multiply(we.makeRotationAxis(Ve.fromArray(i),l)),e.transforms[n.getAttribute("sid")]=n.nodeName;break;case"scale":i=d(n.textContent),e.matrix.scale(Ve.fromArray(i)),e.transforms[n.getAttribute("sid")]=n.nodeName;break;case"extra":break;default:console.log(n)}}return Kt(e.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",e.id):W.nodes[e.id]=e,e}function Vt(t){const e={id:j(t.getAttribute("url")),materials:{},skeletons:[]};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];switch(n.nodeName){case"bind_material":const i=n.getElementsByTagName("instance_material");for(let l=0;l<i.length;l++){const h=i[l],S=h.getAttribute("symbol"),y=h.getAttribute("target");e.materials[S]=j(y)}break;case"skeleton":e.skeletons.push(j(n.textContent));break}}return e}function Cs(t,e){const s=[],n=[];let i,l,h;for(i=0;i<t.length;i++){const A=t[i];let D;if(Kt(A))D=Ue(A),Ut(D,e,s);else if(_s(A)){const F=W.visualScenes[A].children;for(let R=0;R<F.length;R++){const q=F[R];if(q.type==="JOINT"){const O=Ue(q.id);Ut(O,e,s)}}}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",A)}for(i=0;i<e.length;i++)for(l=0;l<s.length;l++)if(h=s[l],h.bone.name===e[i].name){n[i]=h,h.processed=!0;break}for(i=0;i<s.length;i++)h=s[i],h.processed===!1&&(n.push(h),h.processed=!0);const S=[],y=[];for(i=0;i<n.length;i++)h=n[i],S.push(h.bone),y.push(h.boneInverse);return new ei(S,y)}function Ut(t,e,s){t.traverse(function(n){if(n.isBone===!0){let i;for(let l=0;l<e.length;l++){const h=e[l];if(h.name===n.name){i=h.boneInverse;break}}i===void 0&&(i=new Te),s.push({bone:n,boneInverse:i,processed:!1})}})}function Ns(t){const e=[],s=t.matrix,n=t.nodes,i=t.type,l=t.instanceCameras,h=t.instanceControllers,S=t.instanceLights,y=t.instanceGeometries,A=t.instanceNodes;for(let m=0,F=n.length;m<F;m++)e.push(Ue(n[m]));for(let m=0,F=l.length;m<F;m++){const R=Wn(l[m]);R!==null&&e.push(R.clone())}for(let m=0,F=h.length;m<F;m++){const R=h[m],q=J(R.id),O=Dt(q.id),ue=qt(O,R.materials),oe=R.skeletons,ne=q.skin.joints,se=Cs(oe,ne);for(let Se=0,ye=ue.length;Se<ye;Se++){const qe=ue[Se];qe.isSkinnedMesh&&(qe.bind(se,q.skin.bindMatrix),qe.normalizeSkinWeights()),e.push(qe)}}for(let m=0,F=S.length;m<F;m++){const R=Zn(S[m]);R!==null&&e.push(R.clone())}for(let m=0,F=y.length;m<F;m++){const R=y[m],q=Dt(R.id),O=qt(q,R.materials);for(let ue=0,oe=O.length;ue<oe;ue++)e.push(O[ue])}for(let m=0,F=A.length;m<F;m++)e.push(Ue(A[m]).clone());let D;if(n.length===0&&e.length===1)D=e[0];else{D=i==="JOINT"?new Ys:new Zt;for(let m=0;m<e.length;m++)D.add(e[m])}return D.name=i==="JOINT"?t.sid:t.name,D.matrix.copy(s),D.matrix.decompose(D.position,D.quaternion,D.scale),D}const As=new Yt({name:mt.DEFAULT_MATERIAL_NAME,color:16711935});function vs(t,e){const s=[];for(let n=0,i=t.length;n<i;n++){const l=e[t[n]];l===void 0?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",t[n]),s.push(As)):s.push(Jn(l))}return s}function qt(t,e){const s=[];for(const n in t){const i=t[n],l=vs(i.materialKeys,e);if(l.length===0&&(n==="lines"||n==="linestrips"?l.push(new tn):l.push(new He)),n==="lines"||n==="linestrips")for(let A=0,D=l.length;A<D;A++){const m=l[A];if(m.isMeshPhongMaterial===!0||m.isMeshLambertMaterial===!0){const F=new tn;F.color.copy(m.color),F.opacity=m.opacity,F.transparent=m.transparent,l[A]=F}}const h=i.data.attributes.skinIndex!==void 0,S=l.length===1?l[0]:l;let y;switch(n){case"lines":y=new Zs(i.data,S);break;case"linestrips":y=new Xs(i.data,S);break;case"triangles":case"polylist":h?y=new Qs(i.data,S):y=new Le(i.data,S);break}s.push(y)}return s}function Kt(t){return W.nodes[t]!==void 0}function Ue(t){return b(W.nodes[t],Ns)}function Ts(t){const e={name:t.getAttribute("name"),children:[]};ks(t);const s=c(t,"node");for(let n=0;n<s.length;n++)e.children.push(at(s[n]));W.visualScenes[t.getAttribute("id")]=e}function Gt(t){const e=new Zt;e.name=t.name;const s=t.children;for(let n=0;n<s.length;n++){const i=s[n];e.add(Ue(i.id))}return e}function _s(t){return W.visualScenes[t]!==void 0}function Jt(t){return b(W.visualScenes[t],Gt)}function Ss(t){const e=c(t,"instance_visual_scene")[0];return Jt(j(e.getAttribute("url")))}function Es(){const t=W.clips;if(v(t)===!0){if(v(W.animations)===!1){const e=[];for(const s in W.animations){const n=k(s);for(let i=0,l=n.length;i<l;i++)e.push(n[i])}We.push(new Qt("default",-1,e))}}else for(const e in t)We.push(ee(e))}function Rs(t){let e="";const s=[t];for(;s.length;){const n=s.shift();n.nodeType===Node.TEXT_NODE?e+=n.textContent:(e+=`
`,s.push.apply(s,n.childNodes))}return e.trim()}if(r.length===0)return{scene:new Vs};const Bt=new DOMParser().parseFromString(r,"application/xml"),fe=c(Bt,"COLLADA")[0],ct=Bt.getElementsByTagName("parsererror")[0];if(ct!==void 0){const t=c(ct,"div")[0];let e;return t?e=t.textContent:e=Rs(ct),console.error(`THREE.ColladaLoader: Failed to parse collada file.
`,e),null}const Ms=fe.getAttribute("version");console.debug("THREE.ColladaLoader: File version",Ms);const zt=T(c(fe,"asset")[0]),Ht=new mn(this.manager);Ht.setPath(this.resourcePath||a).setCrossOrigin(this.crossOrigin);let lt;rn&&(lt=new rn(this.manager),lt.setPath(this.resourcePath||a));const $e=new bt,We=[];let $t={},Ls=0;const W={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};M(fe,"library_animations","animation",X),M(fe,"library_animation_clips","animation_clip",w),M(fe,"library_controllers","controller",re),M(fe,"library_images","image",E),M(fe,"library_effects","effect",Ce),M(fe,"library_materials","material",Kn),M(fe,"library_cameras","camera",Bn),M(fe,"library_lights","light",Yn),M(fe,"library_geometries","geometry",es),M(fe,"library_nodes","node",at),M(fe,"library_visual_scenes","visual_scene",Ts),M(fe,"library_kinematics_models","kinematics_model",rs),M(fe,"library_physics_models","physics_model",ps),M(fe,"scene","instance_kinematics_scene",gs),G(W.animations,u),G(W.clips,ce),G(W.controllers,Z),G(W.images,$),G(W.effects,Rt),G(W.materials,Mt),G(W.cameras,Lt),G(W.lights,Pt),G(W.geometries,Ft),G(W.visualScenes,Gt),Es(),js();const Ye=Ss(c(fe,"scene")[0]);return Ye.animations=We,zt.upAxis==="Z_UP"&&(console.warn("THREE.ColladaLoader: You are loading an asset with a Z-UP coordinate system. The loader just rotates the asset to transform it into Y-UP. The vertex data are not converted, see #24289."),Ye.rotation.set(-Math.PI/2,0,0)),Ye.scale.multiplyScalar(zt.unit),{get animations(){return console.warn("THREE.ColladaLoader: Please access animations over scene.animations now."),We},kinematics:$t,library:W,scene:Ye}}}const an=new be,Xi=new gn,Xe=new Te,Re=new Te,Ze=new kt,et=new be(1,1,1),tt=new be;class it extends ti{constructor(...r){super(...r),this.urdfNode=null,this.urdfName=""}copy(r,a){return super.copy(r,a),this.urdfNode=r.urdfNode,this.urdfName=r.urdfName,this}}class Zi extends it{constructor(...r){super(...r),this.isURDFCollider=!0,this.type="URDFCollider"}}class eo extends it{constructor(...r){super(...r),this.isURDFVisual=!0,this.type="URDFVisual"}}class An extends it{constructor(...r){super(...r),this.isURDFLink=!0,this.type="URDFLink"}}class vn extends it{get jointType(){return this._jointType}set jointType(r){if(this.jointType!==r)switch(this._jointType=r,this.matrixWorldNeedsUpdate=!0,r){case"fixed":this.jointValue=[];break;case"continuous":case"revolute":case"prismatic":this.jointValue=new Array(1).fill(0);break;case"planar":this.jointValue=new Array(3).fill(0),this.axis=new be(0,0,1);break;case"floating":this.jointValue=new Array(6).fill(0);break}}get angle(){return this.jointValue[0]}constructor(...r){super(...r),this.isURDFJoint=!0,this.type="URDFJoint",this.jointValue=null,this.jointType="fixed",this.axis=new be(1,0,0),this.limit={lower:0,upper:0},this.ignoreLimits=!1,this.origPosition=null,this.origQuaternion=null,this.mimicJoints=[]}copy(r,a){return super.copy(r,a),this.jointType=r.jointType,this.axis=r.axis.clone(),this.limit.lower=r.limit.lower,this.limit.upper=r.limit.upper,this.ignoreLimits=!1,this.jointValue=[...r.jointValue],this.origPosition=r.origPosition?r.origPosition.clone():null,this.origQuaternion=r.origQuaternion?r.origQuaternion.clone():null,this.mimicJoints=[...r.mimicJoints],this}setJointValue(...r){r=r.map(c=>c===null?null:parseFloat(c)),(!this.origPosition||!this.origQuaternion)&&(this.origPosition=this.position.clone(),this.origQuaternion=this.quaternion.clone());let a=!1;switch(this.mimicJoints.forEach(c=>{a=c.updateFromMimickedJoint(...r)||a}),this.jointType){case"fixed":return a;case"continuous":case"revolute":{let c=r[0];return c==null||c===this.jointValue[0]?a:(!this.ignoreLimits&&this.jointType==="revolute"&&(c=Math.min(this.limit.upper,c),c=Math.max(this.limit.lower,c)),this.quaternion.setFromAxisAngle(this.axis,c).premultiply(this.origQuaternion),this.jointValue[0]!==c?(this.jointValue[0]=c,this.matrixWorldNeedsUpdate=!0,!0):a)}case"prismatic":{let c=r[0];return c==null||c===this.jointValue[0]?a:(this.ignoreLimits||(c=Math.min(this.limit.upper,c),c=Math.max(this.limit.lower,c)),this.position.copy(this.origPosition),an.copy(this.axis).applyEuler(this.rotation),this.position.addScaledVector(an,c),this.jointValue[0]!==c?(this.jointValue[0]=c,this.matrixWorldNeedsUpdate=!0,!0):a)}case"floating":return this.jointValue.every((c,f)=>r[f]===c||r[f]===null)?a:(this.jointValue[0]=r[0]!==null?r[0]:this.jointValue[0],this.jointValue[1]=r[1]!==null?r[1]:this.jointValue[1],this.jointValue[2]=r[2]!==null?r[2]:this.jointValue[2],this.jointValue[3]=r[3]!==null?r[3]:this.jointValue[3],this.jointValue[4]=r[4]!==null?r[4]:this.jointValue[4],this.jointValue[5]=r[5]!==null?r[5]:this.jointValue[5],Re.compose(this.origPosition,this.origQuaternion,et),Ze.setFromEuler(Xi.set(this.jointValue[3],this.jointValue[4],this.jointValue[5],"XYZ")),tt.set(this.jointValue[0],this.jointValue[1],this.jointValue[2]),Xe.compose(tt,Ze,et),Re.premultiply(Xe),this.position.setFromMatrixPosition(Re),this.rotation.setFromRotationMatrix(Re),this.matrixWorldNeedsUpdate=!0,!0);case"planar":return this.jointValue.every((c,f)=>r[f]===c||r[f]===null)?a:(this.jointValue[0]=r[0]!==null?r[0]:this.jointValue[0],this.jointValue[1]=r[1]!==null?r[1]:this.jointValue[1],this.jointValue[2]=r[2]!==null?r[2]:this.jointValue[2],Re.compose(this.origPosition,this.origQuaternion,et),Ze.setFromAxisAngle(this.axis,this.jointValue[2]),tt.set(this.jointValue[0],this.jointValue[1],0),Xe.compose(tt,Ze,et),Re.premultiply(Xe),this.position.setFromMatrixPosition(Re),this.rotation.setFromRotationMatrix(Re),this.matrixWorldNeedsUpdate=!0,!0)}return a}}class cn extends vn{constructor(...r){super(...r),this.type="URDFMimicJoint",this.mimicJoint=null,this.offset=0,this.multiplier=1}updateFromMimickedJoint(...r){const a=r.map(c=>c*this.multiplier+this.offset);return super.setJointValue(...a)}copy(r,a){return super.copy(r,a),this.mimicJoint=r.mimicJoint,this.offset=r.offset,this.multiplier=r.multiplier,this}}class to extends An{constructor(...r){super(...r),this.isURDFRobot=!0,this.urdfNode=null,this.urdfRobotNode=null,this.robotName=null,this.links=null,this.joints=null,this.colliders=null,this.visual=null,this.frames=null}copy(r,a){super.copy(r,a),this.urdfRobotNode=r.urdfRobotNode,this.robotName=r.robotName,this.links={},this.joints={},this.colliders={},this.visual={},this.traverse(c=>{c.isURDFJoint&&c.urdfName in r.joints&&(this.joints[c.urdfName]=c),c.isURDFLink&&c.urdfName in r.links&&(this.links[c.urdfName]=c),c.isURDFCollider&&c.urdfName in r.colliders&&(this.colliders[c.urdfName]=c),c.isURDFVisual&&c.urdfName in r.visual&&(this.visual[c.urdfName]=c)});for(const c in this.joints)this.joints[c].mimicJoints=this.joints[c].mimicJoints.map(f=>this.joints[f.name]);return this.frames={...this.colliders,...this.visual,...this.links,...this.joints},this}getFrame(r){return this.frames[r]}setJointValue(r,...a){const c=this.joints[r];return c?c.setJointValue(...a):!1}setJointValues(r){let a=!1;for(const c in r){const f=r[c];Array.isArray(f)?a=this.setJointValue(c,...f)||a:a=this.setJointValue(c,f)||a}return a}}const pt=new kt,ln=new gn;function Je(p){return p?p.trim().split(/\s+/g).map(r=>parseFloat(r)):[0,0,0]}function dn(p,r,a=!1){a||p.rotation.set(0,0,0),ln.set(r[0],r[1],r[2],"ZYX"),pt.setFromEuler(ln),pt.multiply(p.quaternion),p.quaternion.copy(pt)}class Tn{constructor(r){this.manager=r||ni,this.loadMeshCb=this.defaultMeshLoader.bind(this),this.parseVisual=!0,this.parseCollision=!1,this.packages="",this.workingPath="",this.fetchOptions={}}loadAsync(r){return new Promise((a,c)=>{this.load(r,a,null,c)})}load(r,a,c,f){const d=this.manager,x=fn.extractUrlBase(r),j=this.manager.resolveURL(r);d.itemStart(j),fetch(j,this.fetchOptions).then(C=>{if(C.ok)return c&&c(null),C.text();throw new Error(`URDFLoader: Failed to load url '${j}' with error code ${C.status} : ${C.statusText}.`)}).then(C=>{const v=this.parse(C,this.workingPath||x);a(v),d.itemEnd(j)}).catch(C=>{f?f(C):console.error("URDFLoader: Error loading file.",C),d.itemError(j),d.itemEnd(j)})}parse(r,a=this.workingPath){const c=this.packages,f=this.loadMeshCb,d=this.parseVisual,x=this.parseCollision,j=this.manager,C={},v={},T={};function K(L){if(!/^package:\/\//.test(L))return a?a+L:L;const[u,k]=L.replace(/^package:\/\//,"").split(/\/(.+)/);if(typeof c=="string")return c.endsWith(u)?c+"/"+k:c+"/"+u+"/"+k;if(c instanceof Function)return c(u)+"/"+k;if(typeof c=="object")return u in c?c[u]+"/"+k:(console.error(`URDFLoader : ${u} not found in provided package list.`),null)}function H(L){let u;L instanceof Document?u=[...L.children]:L instanceof Element?u=[L]:u=[...new DOMParser().parseFromString(L,"text/xml").children];const k=u.filter(g=>g.nodeName==="robot").pop();return M(k)}function M(L){const u=[...L.children],k=u.filter(I=>I.nodeName.toLowerCase()==="link"),g=u.filter(I=>I.nodeName.toLowerCase()==="joint"),U=u.filter(I=>I.nodeName.toLowerCase()==="material"),z=new to;z.robotName=L.getAttribute("name"),z.urdfRobotNode=L,U.forEach(I=>{const P=I.getAttribute("name");T[P]=X(I)});const _={},N={};k.forEach(I=>{const P=I.getAttribute("name"),te=L.querySelector(`child[link="${P}"]`)===null;C[P]=b(I,_,N,te?z:null)}),g.forEach(I=>{const P=I.getAttribute("name");v[P]=G(I)}),z.joints=v,z.links=C,z.colliders=N,z.visual=_;const Y=Object.values(v);return Y.forEach(I=>{I instanceof cn&&v[I.mimicJoint].mimicJoints.push(I)}),Y.forEach(I=>{const P=new Set,te=ge=>{if(P.has(ge))throw new Error("URDFLoader: Detected an infinite loop of mimic joints.");P.add(ge),ge.mimicJoints.forEach(he=>{te(he)})};te(I)}),z.frames={...N,..._,...C,...v},z}function G(L){const u=[...L.children],k=L.getAttribute("type");let g;const U=u.find(P=>P.nodeName.toLowerCase()==="mimic");U?(g=new cn,g.mimicJoint=U.getAttribute("joint"),g.multiplier=parseFloat(U.getAttribute("multiplier")||1),g.offset=parseFloat(U.getAttribute("offset")||0)):g=new vn,g.urdfNode=L,g.name=L.getAttribute("name"),g.urdfName=g.name,g.jointType=k;let z=null,_=null,N=[0,0,0],Y=[0,0,0];u.forEach(P=>{const te=P.nodeName.toLowerCase();te==="origin"?(N=Je(P.getAttribute("xyz")),Y=Je(P.getAttribute("rpy"))):te==="child"?_=C[P.getAttribute("link")]:te==="parent"?z=C[P.getAttribute("link")]:te==="limit"&&(g.limit.lower=parseFloat(P.getAttribute("lower")||g.limit.lower),g.limit.upper=parseFloat(P.getAttribute("upper")||g.limit.upper))}),z.add(g),g.add(_),dn(g,Y),g.position.set(N[0],N[1],N[2]);const I=u.filter(P=>P.nodeName.toLowerCase()==="axis")[0];if(I){const P=I.getAttribute("xyz").split(/\s+/g).map(te=>parseFloat(te));g.axis=new be(P[0],P[1],P[2]),g.axis.normalize()}return g}function b(L,u,k,g=null){g===null&&(g=new An);const U=[...L.children];return g.name=L.getAttribute("name"),g.urdfName=g.name,g.urdfNode=L,d&&U.filter(_=>_.nodeName.toLowerCase()==="visual").forEach(_=>{const N=V(_,T);if(g.add(N),_.hasAttribute("name")){const Y=_.getAttribute("name");N.name=Y,N.urdfName=Y,u[Y]=N}}),x&&U.filter(_=>_.nodeName.toLowerCase()==="collision").forEach(_=>{const N=V(_);if(g.add(N),_.hasAttribute("name")){const Y=_.getAttribute("name");N.name=Y,N.urdfName=Y,k[Y]=N}}),g}function X(L){const u=[...L.children],k=new He;return k.name=L.getAttribute("name")||"",u.forEach(g=>{const U=g.nodeName.toLowerCase();if(U==="color"){const z=g.getAttribute("rgba").split(/\s/g).map(_=>parseFloat(_));k.color.setRGB(z[0],z[1],z[2]),k.opacity=z[3],k.transparent=z[3]<1,k.depthWrite=!k.transparent}else if(U==="texture"){const z=g.getAttribute("filename");if(z){const _=new mn(j),N=K(z);k.map=_.load(N),k.map.colorSpace=nt}}}),k}function V(L,u={}){const k=L.nodeName.toLowerCase()==="collision",g=[...L.children];let U=null;const z=g.filter(N=>N.nodeName.toLowerCase()==="material")[0];if(z){const N=z.getAttribute("name");N&&N in u?U=u[N]:U=X(z)}else U=new He;const _=k?new Zi:new eo;return _.urdfNode=L,g.forEach(N=>{const Y=N.nodeName.toLowerCase();if(Y==="geometry"){const I=N.children[0].nodeName.toLowerCase();if(I==="mesh"){const P=N.children[0].getAttribute("filename"),te=K(P);if(te!==null){const ge=N.children[0].getAttribute("scale");if(ge){const he=Je(ge);_.scale.set(he[0],he[1],he[2])}f(te,j,(he,w)=>{w?console.error("URDFLoader: Error loading mesh.",w):he&&(he instanceof Le&&(he.material=U),he.position.set(0,0,0),he.quaternion.identity(),_.add(he))})}}else if(I==="box"){const P=new Le;P.geometry=new si(1,1,1),P.material=U;const te=Je(N.children[0].getAttribute("size"));P.scale.set(te[0],te[1],te[2]),_.add(P)}else if(I==="sphere"){const P=new Le;P.geometry=new ii(1,30,30),P.material=U;const te=parseFloat(N.children[0].getAttribute("radius"))||0;P.scale.set(te,te,te),_.add(P)}else if(I==="cylinder"){const P=new Le;P.geometry=new oi(1,1,1,30),P.material=U;const te=parseFloat(N.children[0].getAttribute("radius"))||0,ge=parseFloat(N.children[0].getAttribute("length"))||0;P.scale.set(te,ge,te),P.rotation.set(Math.PI/2,0,0),_.add(P)}}else if(Y==="origin"){const I=Je(N.getAttribute("xyz")),P=Je(N.getAttribute("rpy"));_.position.set(I[0],I[1],I[2]),_.rotation.set(0,0,0),dn(_,P)}}),_}return H(r)}defaultMeshLoader(r,a,c){/\.stl$/i.test(r)?new Yi(a).load(r,d=>{const x=new Le(d,new He);c(x)}):/\.dae$/i.test(r)?new Qi(a).load(r,d=>c(d.scene)):console.warn(`URDFLoader: Could not load model at ${r}.
No loader available`)}}const no=()=>{const p=B.useRef(null),r=B.useRef(null);return B.useEffect(()=>{const a=new Tn;a.packages={"":"/models/urdf/"},a.load("/models/urdf/armatron.urdf",f=>{p.current&&(r.current=f,p.current.add(f),f.position.set(0,0,0),f.scale.set(1,1,1),console.log("Available joints:",Object.keys(f.joints)))},f=>{console.log("Loading progress:",f)},f=>{console.error("Error loading URDF:",f)});const c=()=>{if(!r.current)return;const f=ke.getState();Object.entries(f.motors).forEach(([d,x])=>{const j=x.multiTurnRad_Mapped??0,C=`J${d}`,v=r.current;v.setJointValue?C==="J6"?v.setJointValue(C,f.diff_pitch_rad??0)||console.warn(`Failed to set joint ${C} to pitch angle ${f.diff_pitch_rad}!`):C==="J7"?v.setJointValue(C,f.diff_roll_rad??0)||console.warn(`Failed to set joint ${C} to roll angle ${f.diff_roll_rad}!`):v.setJointValue(C,j)||console.warn(`Failed to set joint ${C} to angle ${j}!`):console.warn("URDFRobot does not have setJointValue method")})};return ke.on("update",c),()=>{ke.off("update",c)}},[]),bn(()=>{}),o.jsx("group",{ref:p})},so=({opacity:p=.5})=>{const r=B.useRef(null),a=B.useRef(null);return B.useEffect(()=>{const c=new Tn;c.packages={"":"/models/urdf/"},c.load("/models/urdf/armatron.urdf",d=>{r.current&&(a.current=d,r.current.add(d),d.position.set(0,0,0),d.scale.set(1,1,1),d.traverse(x=>{x instanceof Le&&x.material instanceof ri&&(x.material.transparent=!0,x.material.opacity=p)}),console.log("Digital Twin - Available joints:",Object.keys(d.joints)))},d=>{console.log("Digital Twin - Loading progress:",d)},d=>{console.error("Digital Twin - Error loading URDF:",d)});const f=()=>{var x;if(!a.current)return;const d=ke.getState();(x=d.twin)!=null&&x.active&&d.twin.joint_angles_deg.forEach((j,C)=>{var K,H,M,G;const v=`J${C+1}`,T=a.current;T.setJointValue?v==="J6"?T.setJointValue(v,((K=d.twin)==null?void 0:K.joint_angles_deg[5])??0)||console.warn(`Digital Twin - Failed to set joint ${v} to pitch angle ${((H=d.twin)==null?void 0:H.joint_angles_deg[5])??0}!`):v==="J7"?T.setJointValue(v,((M=d.twin)==null?void 0:M.joint_angles_deg[6])??0)||console.warn(`Digital Twin - Failed to set joint ${v} to roll angle ${((G=d.twin)==null?void 0:G.joint_angles_deg[6])??0}!`):C<5&&(T.setJointValue(v,j*(Math.PI/180))||console.warn(`Digital Twin - Failed to set joint ${v} to angle ${j}!`)):console.warn("Digital Twin - URDFRobot does not have setJointValue method")})};return ke.on("update",f),()=>{ke.off("update",f)}},[p]),bn(()=>{}),o.jsx("group",{ref:r})},io=({style:p})=>{const r=vi();return o.jsx(xe,{elevation:3,sx:{width:"100%",height:"100%",minHeight:"400px",backgroundColor:r.palette.background.paper,...p},children:o.jsxs(ai,{orthographic:!0,camera:{position:[5,0,5],zoom:400,near:.1,far:1e3,up:[0,0,1]},style:{width:"100%",height:"100%"},gl:{antialias:!0},children:[o.jsx("color",{attach:"background",args:["#263238"]}),o.jsxs(B.Suspense,{fallback:null,children:[o.jsx("ambientLight",{intensity:.3}),o.jsx("directionalLight",{position:[5,30,5],intensity:1,castShadow:!0,"shadow-mapSize":[1024,1024]}),o.jsx("pointLight",{position:[1,0,2.2],intensity:.8,distance:100,decay:2}),o.jsx(ci,{makeDefault:!0,enableDamping:!0,dampingFactor:.05,rotateSpeed:.5,target:[0,0,0],minPolarAngle:0,maxPolarAngle:Math.PI/2,up:[0,0,1]}),o.jsx(no,{}),o.jsx(so,{opacity:.5}),o.jsx(li,{args:[.6096,.9144],position:[.2032,0,0],rotation:[Math.PI/2,0,0],cellSize:.0254,cellThickness:.5,cellColor:"#6f6f6f",sectionSize:.1524,sectionThickness:1,sectionColor:"#9d4b4b",fadeDistance:30,fadeStrength:1,followCamera:!1,infiniteGrid:!1}),o.jsx("primitive",{object:new di(.33)})]})]})})};var Ct={},ft={};const oo=hi(Ti);var un;function ot(){return un||(un=1,function(p){"use client";Object.defineProperty(p,"__esModule",{value:!0}),Object.defineProperty(p,"default",{enumerable:!0,get:function(){return r.createSvgIcon}});var r=oo}(ft)),ft}var ro=st;Object.defineProperty(Ct,"__esModule",{value:!0});var _n=Ct.default=void 0,ao=ro(ot()),co=o;_n=Ct.default=(0,ao.default)((0,co.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete");var Nt={},lo=st;Object.defineProperty(Nt,"__esModule",{value:!0});var Sn=Nt.default=void 0,uo=lo(ot()),ho=o;Sn=Nt.default=(0,uo.default)((0,ho.jsx)("path",{d:"M8 5v14l11-7z"}),"PlayArrow");var At={},po=st;Object.defineProperty(At,"__esModule",{value:!0});var En=At.default=void 0,fo=po(ot()),mo=o;En=At.default=(0,fo.default)((0,mo.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit");var vt={},go=st;Object.defineProperty(vt,"__esModule",{value:!0});var Rn=vt.default=void 0,bo=go(ot()),xo=o;Rn=vt.default=(0,bo.default)((0,xo.jsx)("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"}),"ContentCopy");const yo=()=>{const[p,r]=B.useState([0,0,0,0,0,0,0]),[a,c]=B.useState(""),[f,d]=B.useState([]),[x,j]=B.useState(null),[C,v]=B.useState(!1);B.useEffect(()=>{fetch("/api/positions").then(u=>u.json()).then(u=>d(u)).catch(u=>console.error("Error loading positions:",u))},[]);const T=(u,k)=>{const g=[...p];g[u]=parseFloat(k)||0,r(g)},K=u=>{let k=u,g=1;for(;f.some(U=>U.name===k);)k=`${u}_${g}`,g++;return k},H=()=>{if(!a.trim())return;const u={id:Date.now().toString(),name:a,angles:[...p]};fetch("/api/positions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}).then(k=>k.json()).then(k=>{d(g=>[...g,k]),c("")}).catch(k=>console.error("Error saving position:",k))},M=u=>{fetch(`/api/positions/${u}`,{method:"DELETE"}).then(()=>{d(k=>k.filter(g=>g.id!==u))}).catch(k=>console.error("Error deleting position:",k))},G=u=>{de.sendCommand({cmd:"moveToJointPositionRuckig",angles:u})},b=u=>{j(u),v(!0)},X=()=>{x&&fetch(`/api/positions/${x.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)}).then(u=>u.json()).then(u=>{d(k=>k.map(g=>g.id===u.id?u:g)),v(!1),j(null)}).catch(u=>console.error("Error updating position:",u))},V=u=>{const k={id:Date.now().toString(),name:K(u.name),angles:[...u.angles]};fetch("/api/positions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)}).then(g=>g.json()).then(g=>{d(U=>[...U,g])}).catch(g=>console.error("Error duplicating position:",g))},L=["Joint 1","Joint 2","Joint 3","Joint 4","Joint 5","Wrist Roll","Wrist Pitch"];return o.jsxs(xe,{sx:{p:2,height:"100%",display:"flex",flexDirection:"column"},children:[o.jsx(Ae,{variant:"h6",gutterBottom:!0,children:"Joint Position Control"}),o.jsx(_e,{container:!0,spacing:1,sx:{mb:2},children:L.map((u,k)=>o.jsx(_e,{item:!0,xs:12,sm:6,md:4,lg:3,children:o.jsx(Me,{fullWidth:!0,label:u,type:"number",value:p[k],onChange:g=>T(k,g.target.value),size:"small",inputProps:{step:"0.1"}})},k))}),o.jsxs(_e,{container:!0,spacing:2,sx:{mb:2},children:[o.jsx(_e,{item:!0,xs:8,children:o.jsx(Me,{fullWidth:!0,label:"Position Name",value:a,onChange:u=>c(u.target.value),size:"small"})}),o.jsx(_e,{item:!0,xs:4,children:o.jsx(je,{fullWidth:!0,variant:"contained",onClick:H,disabled:!a.trim(),children:"Save Position"})})]}),o.jsx(Ae,{variant:"subtitle1",gutterBottom:!0,children:"Saved Positions"}),o.jsx(xn,{dense:!0,sx:{flexGrow:1,overflow:"auto"},children:f.map(u=>o.jsxs(yn,{children:[o.jsx(jn,{primary:u.name,secondary:`Angles: ${u.angles.map(k=>k.toFixed(1)).join(", ")}`}),o.jsxs(_i,{children:[o.jsx(ze,{edge:"end","aria-label":"run",onClick:()=>G(u.angles),sx:{mr:1},children:o.jsx(Sn,{})}),o.jsx(ze,{edge:"end","aria-label":"edit",onClick:()=>b(u),sx:{mr:1},children:o.jsx(En,{})}),o.jsx(ze,{edge:"end","aria-label":"duplicate",onClick:()=>V(u),sx:{mr:1},children:o.jsx(Rn,{})}),o.jsx(ze,{edge:"end","aria-label":"delete",onClick:()=>M(u.id),children:o.jsx(_n,{})})]})]},u.id))}),o.jsxs(wn,{open:C,onClose:()=>v(!1),children:[o.jsx(kn,{children:"Edit Position"}),o.jsxs(Cn,{children:[o.jsx(Me,{autoFocus:!0,margin:"dense",label:"Position Name",fullWidth:!0,value:(x==null?void 0:x.name)||"",onChange:u=>j(k=>k?{...k,name:u.target.value}:null)}),o.jsx(_e,{container:!0,spacing:1,sx:{mt:2},children:L.map((u,k)=>o.jsx(_e,{item:!0,xs:12,sm:6,md:4,lg:3,children:o.jsx(Me,{fullWidth:!0,label:u,type:"number",value:(x==null?void 0:x.angles[k])||0,onChange:g=>{const U=[...(x==null?void 0:x.angles)||[]];U[k]=parseFloat(g.target.value)||0,j(z=>z?{...z,angles:U}:null)},size:"small",inputProps:{step:"0.1"}})},k))})]}),o.jsxs(Nn,{children:[o.jsx(je,{onClick:()=>v(!1),children:"Cancel"}),o.jsx(je,{onClick:X,variant:"contained",children:"Save"})]})]})]})},jo=Ie(xe)(({theme:p})=>({padding:p.spacing(2),height:"300px",overflow:"auto",backgroundColor:p.palette.background.default,fontFamily:"monospace",whiteSpace:"pre-wrap",wordBreak:"break-word"})),hn=Ie("div")(({theme:p})=>({marginBottom:p.spacing(.5),fontSize:"0.875rem",lineHeight:1.5})),wo=()=>{const[p,r]=B.useState([]),[a,c]=B.useState(null),[f,d]=B.useState(!1),x=B.useRef(null);return B.useEffect(()=>{de.isConnected()||de.connect();const j=()=>{console.log("Socket connected, subscribing to logs"),d(!0),de.emit("subscribeToLogs")},C=()=>{console.log("Socket disconnected"),d(!1)},v=K=>{console.log("Received logs:",K.logs),r(H=>[...H,...K.logs].slice(-1e3)),c(null)},T=K=>{console.error("Log error:",K),c(K.message)};return de.on("connect",j),de.on("disconnect",C),de.on("serviceLogs",v),de.on("error",T),de.isConnected()&&j(),()=>{de.off("connect",j),de.off("disconnect",C),de.off("serviceLogs",v),de.off("error",T),de.emit("unsubscribeFromLogs")}},[]),B.useEffect(()=>{x.current&&(x.current.scrollTop=x.current.scrollHeight)},[p]),o.jsxs(xe,{sx:{p:2,mt:2},children:[o.jsxs(Ae,{variant:"h6",gutterBottom:!0,children:["Service Logs ",!f&&"(Connecting...)"]}),a?o.jsx(Ae,{color:"error",children:a}):o.jsx(jo,{ref:x,children:p.length===0&&f?o.jsx(hn,{children:"Waiting for logs..."}):p.map((j,C)=>o.jsx(hn,{children:j},`${C}-${j}`))})]})},ko=Ie(je)(({theme:p})=>({backgroundColor:p.palette.error.main,color:p.palette.error.contrastText,"&:hover":{backgroundColor:p.palette.error.dark},marginTop:p.spacing(2)})),Co=()=>{var K,H;const[p,r]=B.useState(ke.getState()),[a,c]=B.useState(0),[f,d]=B.useState(0),[x,j]=B.useState(60);B.useEffect(()=>{const M=()=>{r(ke.getState())};return ke.on("update",M),()=>{ke.off("update",M)}},[]);const C=()=>{const M=a*(Math.PI/180),G=f*(Math.PI/180);de.sendCommand({cmd:"setDifferentialAngles",roll:M,pitch:G,maxSpeed:x})},v=()=>{me.emergencyStop()},T=M=>{var V,L;const G=p.motors[M];return G?`Position: ${parseInt(M)>=6?((V=G.multiTurnRaw)==null?void 0:V.toFixed(2))??"-1":((L=G.multiTurnDeg_Mapped)==null?void 0:L.toFixed(2))??"-1"}Â° | Speed: ${G.speedDeg_s.toFixed(2)}Â°/s | Temp: ${G.temp}Â°C`:"Unknown"};return o.jsx("div",{style:{width:"100%"},children:o.jsxs(_e,{container:!0,spacing:3,children:[o.jsx(_e,{item:!0,xs:12,md:4,children:o.jsxs(xe,{sx:{p:2,height:"100%"},children:[o.jsxs(xe,{sx:{p:2,mb:2,backgroundColor:"transparent",boxShadow:"none"},children:[o.jsx(Ae,{variant:"h6",gutterBottom:!0,children:"Robot Status"}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[p.connected?o.jsx(on,{label:"Connected",color:"success",size:"small"}):o.jsx(on,{label:"Disconnected",color:"error",size:"small"}),o.jsxs(Ae,{variant:"caption",color:"text.secondary",children:["Last Update: ",new Date(p.lastUpdate).toLocaleTimeString()]})]})]}),o.jsxs(xe,{sx:{p:2,mb:2},children:[o.jsx(Ae,{variant:"h6",gutterBottom:!0,children:"Wrist Control"}),o.jsxs(xe,{sx:{mb:2},children:[o.jsxs(Ae,{variant:"body2",children:["Current Roll: ",(K=p.diff_roll_deg)==null?void 0:K.toFixed(2),"Â°"]}),o.jsxs(Ae,{variant:"body2",children:["Current Pitch: ",(H=p.diff_pitch_deg)==null?void 0:H.toFixed(2),"Â°"]})]}),o.jsxs(xe,{sx:{display:"flex",flexDirection:"column",gap:2},children:[o.jsx(Me,{label:"Target Roll (deg)",type:"number",value:a,onChange:M=>c(parseFloat(M.target.value)||0),size:"small",inputProps:{step:"any"}}),o.jsx(Me,{label:"Target Pitch (deg)",type:"number",value:f,onChange:M=>d(parseFloat(M.target.value)||0),size:"small",inputProps:{step:"any"}}),o.jsx(Me,{label:"Max Motor Speed (deg/s)",type:"number",value:x,onChange:M=>j(parseFloat(M.target.value)||0),size:"small",inputProps:{step:"any"}}),o.jsx(je,{variant:"contained",onClick:C,disabled:!p.connected,children:"Move Wrist"})]})]}),o.jsxs(xe,{sx:{p:2,mb:2},children:[o.jsx(Ae,{variant:"h6",gutterBottom:!0,children:"Emergency Stop"}),o.jsx(ko,{variant:"contained",onClick:v,disabled:!p.connected,fullWidth:!0,children:"EMERGENCY STOP"})]}),o.jsx(Ae,{variant:"h6",gutterBottom:!0,children:"Motor States"}),o.jsx(xn,{dense:!0,children:Object.keys(p.motors).map(M=>o.jsx(yn,{children:o.jsx(jn,{primary:`Motor ${M}`,secondary:T(M),primaryTypographyProps:{variant:"body2"},secondaryTypographyProps:{variant:"caption"}})},M))})]})}),o.jsx(_e,{item:!0,xs:12,md:4,children:o.jsx(yo,{})}),o.jsxs(_e,{item:!0,xs:12,md:4,children:[o.jsx(xe,{sx:{p:2,height:"600px"},children:o.jsx(io,{})}),o.jsx(wo,{})]})]})})},Mn=B.createContext({mode:"dark",toggleTheme:()=>{}}),No=()=>B.useContext(Mn),Ao=({children:p})=>{const[r,a]=B.useState("dark"),c=()=>{a(d=>d==="light"?"dark":"light")},f=Si({palette:{mode:r,background:{default:r==="dark"?"#121212":"#f5f5f5",paper:r==="dark"?"#1e1e1e":"#ffffff"}},components:{MuiPaper:{styleOverrides:{root:{backgroundColor:r==="dark"?"#1e1e1e":"#ffffff"}}}}});return o.jsx(Mn.Provider,{value:{mode:r,toggleTheme:c},children:o.jsx(Ei,{theme:f,children:o.jsx("div",{style:{backgroundColor:f.palette.background.default,minHeight:"100vh",color:f.palette.text.primary},children:p})})})},vo=({open:p,onClose:r,onSetModifier:a})=>{const[c,f]=B.useState(1),[d,x]=B.useState("1"),j=(T,K)=>{const H=K;f(H),x(H.toString())},C=T=>{const K=T.target.value;x(K);const H=parseFloat(K);!isNaN(H)&&H>=0&&H<=1&&f(H)},v=()=>{a(c)};return o.jsxs(wn,{open:p,onClose:r,maxWidth:"sm",fullWidth:!0,children:[o.jsx(kn,{children:"Settings"}),o.jsx(Cn,{children:o.jsxs(xe,{sx:{mt:2},children:[o.jsx(Ae,{gutterBottom:!0,children:"Max Speed Modifier"}),o.jsxs(xe,{sx:{display:"flex",alignItems:"center",gap:2},children:[o.jsx(Ri,{value:c,onChange:j,min:0,max:1,step:.01,sx:{flex:1}}),o.jsx(Me,{size:"small",value:d,onChange:C,inputProps:{min:0,max:1,step:.01,type:"number"},sx:{width:"100px"}})]})]})}),o.jsxs(Nn,{children:[o.jsx(je,{onClick:r,children:"Cancel"}),o.jsx(je,{onClick:v,variant:"contained",children:"Set Modifier"})]})]})},To=({children:p})=>{const{mode:r,toggleTheme:a}=No(),[c,f]=xt.useState(null),[d,x]=xt.useState(!1),j=G=>{f(G.currentTarget)},C=()=>{f(null)},v=()=>{x(!0)},T=()=>{x(!1)},K=G=>{de.sendCommand({cmd:"setMaxSpeedModifier",modifier:G}),x(!1)},H=()=>{de.sendCommand({cmd:"setESTOP"})},M=()=>{de.sendCommand({cmd:"setHoldPosition"})};return o.jsxs("div",{style:{display:"flex",flexDirection:"column",minHeight:"100vh"},children:[o.jsx(Mi,{position:"static",component:xe,elevation:0,children:o.jsxs(Li,{children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",flexGrow:1},children:[o.jsx(je,{component:ut,to:"/",startIcon:o.jsx(Pi,{}),sx:{color:"inherit",textTransform:"none",fontSize:"1.2rem",fontWeight:"bold",mr:2},children:"Armatron"}),o.jsx(je,{color:"inherit",component:ut,to:"/",sx:{mr:2},children:"Dashboard"}),o.jsx(je,{color:"inherit",component:ut,to:"/joint-control",sx:{mr:2},children:"Joint Control"})]}),o.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[o.jsx(je,{color:"inherit",startIcon:o.jsx(Fi,{}),onClick:j,sx:{mr:1},children:"Positions"}),o.jsxs(Di,{anchorEl:c,open:!!c,onClose:C,children:[o.jsx(ht,{onClick:C,children:"Virtual Home"}),o.jsx(ht,{onClick:C,children:"Gravity Safe #1"}),o.jsx(ht,{onClick:C,children:"Example #3"})]}),o.jsx(je,{color:"inherit",startIcon:o.jsx(Ii,{}),onClick:M,sx:{mr:1},children:"HOLD"}),o.jsx(je,{color:"error",startIcon:o.jsx(Oi,{}),onClick:H,sx:{mr:1},children:"ESTOP"}),o.jsx(je,{color:"inherit",startIcon:o.jsx(Vi,{}),onClick:v,sx:{mr:1},children:"Settings"}),o.jsx(Ui,{orientation:"vertical",flexItem:!0,sx:{mx:1}}),o.jsx(ze,{onClick:a,color:"inherit",children:r==="dark"?o.jsx(qi,{}):o.jsx(Ki,{})})]})]})}),o.jsx("main",{style:{flexGrow:1,padding:"24px"},children:p}),o.jsx(vo,{open:d,onClose:T,onSetModifier:K})]})},_o=()=>(B.useEffect(()=>(de.connect(),()=>{}),[]),o.jsx(To,{children:o.jsxs(fi,{children:[o.jsx(sn,{path:"/",element:o.jsx(Co,{})}),o.jsx(sn,{path:"/joint-control",element:o.jsx(Wi,{})})]})})),So=()=>o.jsx(Ao,{children:o.jsx(pi,{children:o.jsx(_o,{})})});ui.createRoot(document.getElementById("root")).render(o.jsx(xt.StrictMode,{children:o.jsx(So,{})}));
//# sourceMappingURL=main-CebhPmm-.js.map
